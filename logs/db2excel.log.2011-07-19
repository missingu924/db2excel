[2011-07-19 22:56:26][com.inspur.db2excel.Main.db2excel(Main.java:94)][INFO][main]-pm.xml:=====Excel文件../excel/pm/20110719/数据完整性-20110719_225626.xls开始创建=====
[2011-07-19 22:56:29][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-pm.xml:-----GSM-归一化性能数据条数统计 生成开始-----
[2011-07-19 22:56:29][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-pm.xml:GSM-归一化性能数据条数统计 sql: select 
			sysdate 检测时间,
			'山东' 省份,
			to_char(t2.time,'yyyy-mm-dd hh24') 指标时间,
			t3.vendor_name 厂商,
			t3.bsc_count 理论BSC数,
			t0.bsc_count_real 实际BSC数,
			t1.bsc_count_real 数据正常BSC数,
			round(nvl(t1.bsc_count_real,0)/t3.bsc_count*100,2)||'%' BSC数据完整率,
			t3.cell_count 理论小区数,
			t0.cell_count_real 实际小区数,
			t1.cell_count_real 数据正常小区数,
			round(nvl(t1.cell_count_real,0)/t3.cell_count*100,2) ||'%' 小区数据完整率
		from time_list t2
		left join
		(
			select vendor_name,count(distinct bsc_uk) bsc_count,count(*) cell_count from cm.f_g_c_cell 
			where bsc_uk is not null and state='入网在用' group by vendor_name	
		) t3
		on 1=1
		left join
		(	select 
				start_time,
				vendor_name,
				count(distinct bsc_uk) bsc_count_real,
				count(*) cell_count_real
			from pm.f_g_c_cell_hour
			where start_time>=sysdate-12/24
			group by start_time,vendor_name) t0
		on t0.vendor_name=t3.vendor_name and t0.start_time=t2.time 
		left join
		(	select 
				start_time,
				vendor_name,
				count(distinct bsc_uk) bsc_count_real,
				count(*) cell_count_real
			from pm.f_g_c_cell_hour
			where start_time>=sysdate-12/24 and bsche00 is not null
			group by start_time,vendor_name) t1
		on t1.vendor_name=t3.vendor_name and t1.start_time=t2.time
		where t2.time>=sysdate-12/24 and t2.time<sysdate-3/24
		order by 4,3
[2011-07-19 22:56:47][com.inspur.db2excel.Main.oneTable2Excel(Main.java:198)][INFO][main]-pm.xml:GSM-归一化性能数据条数统计 共保存了27条记录
[2011-07-19 22:56:47][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-pm.xml:-----GSM-归一化性能数据条数统计 生成完成-----
[2011-07-19 22:56:47][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-pm.xml:-----GSM-爱立信-原始CONTER数据条数统计 生成开始-----
[2011-07-19 22:56:47][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-pm.xml:GSM-爱立信-原始CONTER数据条数统计 sql: select 
        to_char(sysdate,'yyyy-mm-dd hh24:mi:ss') 检测时间,
        to_char(t2.time,'yyyy-mm-dd hh24') 指标时间,
        '爱立信' 厂商,
        t1.bsc_count 理论BSC数,
        nvl(t0.bsc_count,0) 实际BSC数,
        t1.cell_count 理论小区数,
        nvl(t0.cell_count,0) 实际小区数,
        round(nvl(t0.cell_count,0)/t1.cell_count*100,2)||'%' 数据完整率
    from time_list t2
    left join
        (select count(distinct bsc_uk) bsc_count,count(*) cell_count from cm.f_g_c_cell 
        where vendor_uk=1 and bsc_uk is not null and state='入网在用') t1 
    on 1=1
    left join
        (select  start_time,count(distinct bsc_uk) bsc_count,count(*) cell_count from pm.o_g_e_r12_h_celtchf 
        where    start_time >=sysdate-1
        group by start_time ) t0
    on t2.time=t0.start_time
        where 
        t2.time>=sysdate-1 and t2.time<sysdate-3/24
        order by 2
[2011-07-19 22:58:38][com.inspur.db2excel.Main.oneTable2Excel(Main.java:198)][INFO][main]-pm.xml:GSM-爱立信-原始CONTER数据条数统计 共保存了21条记录
[2011-07-19 22:58:38][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-pm.xml:-----GSM-爱立信-原始CONTER数据条数统计 生成完成-----
[2011-07-19 22:58:38][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-pm.xml:-----GSM-诺基亚-原始CONTER数据条数统计 生成开始-----
[2011-07-19 22:58:38][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-pm.xml:GSM-诺基亚-原始CONTER数据条数统计 sql: select 
        to_char(sysdate,'yyyy-mm-dd hh24:mi:ss') 检测时间,
        to_char(t2.time,'yyyy-mm-dd hh24') 指标时间,
        '诺基亚' 厂商,
        t1.bsc_count 理论BSC数,
        nvl(t0.bsc_count,0) 实际BSC数,
        t1.cell_count 理论小区数,
        nvl(t0.cell_count,0) 实际小区数,
        round(nvl(t0.cell_count,0)/t1.cell_count*100,2)||'%' 数据完整率
    from time_list t2
    left join
        (select count(distinct bsc_uk) bsc_count,count(*) cell_count from cm.f_g_c_cell 
        where vendor_uk=15 and bsc_uk is not null and state='入网在用') t1 
    on 1=1
    left join
        (select  start_time,count(distinct bsc_uk) bsc_count,count(*) cell_count from pm.o_g_n_s14_h_traffic  
        where    start_time >=sysdate-1
        group by start_time ) t0
    on t2.time=t0.start_time
        where 
        t2.time>=sysdate-1 and t2.time<sysdate-3/24
        order by 2
[2011-07-19 22:58:45][com.inspur.db2excel.Main.oneTable2Excel(Main.java:198)][INFO][main]-pm.xml:GSM-诺基亚-原始CONTER数据条数统计 共保存了21条记录
[2011-07-19 22:58:45][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-pm.xml:-----GSM-诺基亚-原始CONTER数据条数统计 生成完成-----
[2011-07-19 22:58:45][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-pm.xml:-----GSM-华为-原始CONTER数据条数统计 生成开始-----
[2011-07-19 22:58:45][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-pm.xml:GSM-华为-原始CONTER数据条数统计 sql: select 
        to_char(sysdate,'yyyy-mm-dd hh24:mi:ss') 检测时间,
        to_char(t2.time,'yyyy-mm-dd hh24') 指标时间,
        '华为' 厂商,
        t1.bsc_count 理论BSC数,
        nvl(t0.bsc_count,0) 实际BSC数,
        t1.cell_count 理论小区数,
        nvl(t0.cell_count,0) 实际小区数,
        round(nvl(t0.cell_count,0)/t1.cell_count*100,2)||'%' 数据完整率
    from time_list t2
    left join
        (select count(distinct bsc_uk) bsc_count,count(*) cell_count from cm.f_g_c_cell 
        where vendor_uk=5 and bsc_uk is not null and state='入网在用') t1 
    on 1=1
    left join
        (select  start_time,count(distinct bsc_uk) bsc_count,count(*) cell_count from pm.O_G_H_R11_1275071420_3  
        where    start_time >=sysdate-1
        group by start_time ) t0
    on t2.time=t0.start_time
        where 
        t2.time>=sysdate-1 and t2.time<sysdate-3/24
        order by 2
[2011-07-19 22:58:52][com.inspur.db2excel.Main.oneTable2Excel(Main.java:198)][INFO][main]-pm.xml:GSM-华为-原始CONTER数据条数统计 共保存了21条记录
[2011-07-19 22:58:52][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-pm.xml:-----GSM-华为-原始CONTER数据条数统计 生成完成-----
[2011-07-19 22:58:52][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-pm.xml:-----GSM-参数数据条数统计 生成开始-----
[2011-07-19 22:58:52][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-pm.xml:GSM-参数数据条数统计 sql: select 
		t2.start_time 时间,
		t1.vendor_name 厂商,
		t1.bsc_count BSC理论数量,
		t0.bsc_real_count BSC实际数量,
		round(nvl(t0.bsc_real_count,0)/t1.bsc_count*100,2)||'%' BSC数据完整率,
		t1.cell_count 小区理论数量,
		t0.cell_real_count 小区实际数量,
		round(nvl(t0.cell_real_count,0)/t1.cell_count*100,2)||'%' 小区数据完整率
		from 
		(select count(distinct bsc_name) bsc_count,count(*) cell_count,vendor_name from cm.f_g_c_cell  where state='入网在用' group by vendor_name) 
		t1
		left join
		(
		select trunc(sysdate) start_time from dual
		union
		select trunc(sysdate-1) start_time from dual
		union
		select trunc(sysdate-2) start_time from dual
		union
		select trunc(sysdate-3) start_time from dual
		union
		select trunc(sysdate-4) start_time from dual
		) t2
		on 1=1
		left join
		(
		select start_time,'爱立信' vendor_name,count(distinct bsc) bsc_real_count,count(*) cell_real_count from cm.g_e_c_internal_cell where start_time>sysdate-5 and cell not like 'B%' and cell not like '%TEST%' group by start_time
		union
		select start_time,'华为' vendor_name,count(distinct lac) bsc_real_count,count(*) cell_real_count from cm.g_h_c_cell where start_time>sysdate-5 and cell_uk not like 'B%' and cell_uk not like '%TEST%' group by start_time
		union
		select start_time,'诺基亚' vendor_name,count(distinct bsc_uk) bsc_real_count,count(*) cell_real_count from cm.g_n_c_bts where start_time>sysdate-5 and cell_uk not like 'B%' and cell_uk not like '%TEST%' group by start_time)
		t0
		on t0.start_time=t2.start_time and t1.vendor_name=t0.vendor_name
		order by 1 desc,2
[2011-07-19 22:58:59][com.inspur.db2excel.Main.oneTable2Excel(Main.java:198)][INFO][main]-pm.xml:GSM-参数数据条数统计 共保存了15条记录
[2011-07-19 22:58:59][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-pm.xml:-----GSM-参数数据条数统计 生成完成-----
[2011-07-19 22:58:59][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-pm.xml:-----TD-参数数据条数统计 生成开始-----
[2011-07-19 22:58:59][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-pm.xml:TD-参数数据条数统计 sql: select
		t2.start_time 时间,
		t1.vendor_name 厂商,
		nvl(t0.rnc_real_count,0) RNC实际数,
		t1.rnc_count RNC理论数,
		round(nvl(t0.rnc_real_count,0)/t1.rnc_count*100,2)||'%' RNC数据完整率,
		nvl(t0.utrancell_real_count,0) 小区实际数,
		t1.utrancell_count 小区理论数,
		round(nvl(t0.utrancell_real_count,0)/t1.utrancell_count*100,2)||'%' 小区数据完整率
		from 
		(select vendor_name,count(distinct rnc_uk) rnc_count,count(*) utrancell_count from cm.f_t_c_utrancell where status='入网在用' group by vendor_name) 
		t1
		left join
		(
		select trunc(sysdate+1) start_time from dual
		union
		select trunc(sysdate) start_time from dual
		union
		select trunc(sysdate-1) start_time from dual
		) t2
		on 1=1
		left join
		(
		select '中兴' vendor_name,count(distinct rnc_name) rnc_real_count,count(*) utrancell_real_count,start_time from cm.o_t_z_utrancell where start_time>sysdate-3 group by start_time
		union
		select '华为' vendor_name,count(distinct rnc_name) rnc_real_count,count(*) utrancell_real_count,start_time from cm.o_t_h_utrancell where start_time>sysdate-3 group by start_time
		union
		select '大唐' vendor_name,count(distinct rnc_name) rnc_real_count,count(*) utrancell_real_count,start_time from cm.o_t_d_utrancell where start_time>sysdate-3 group by start_time
		union
		select '烽火' vendor_name,count(distinct rnc_name) rnc_real_count,count(*) utrancell_real_count,start_time from cm.o_t_f_utrancell where start_time>sysdate-3 group by start_time
		) t0
		on t0.vendor_name=t1.vendor_name and t0.start_time=t2.start_time
		order by 1 desc,2
[2011-07-19 22:59:01][com.inspur.db2excel.Main.oneTable2Excel(Main.java:198)][INFO][main]-pm.xml:TD-参数数据条数统计 共保存了15条记录
[2011-07-19 22:59:01][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-pm.xml:-----TD-参数数据条数统计 生成完成-----
[2011-07-19 22:59:01][com.inspur.db2excel.Main.db2excel(Main.java:117)][INFO][main]-pm.xml:=====Excel文件../excel/pm/20110719/数据完整性-20110719_225626.xls保存完成=====
[2011-07-19 23:11:02][com.inspur.db2excel.Main.db2excel(Main.java:94)][INFO][main]-pm.xml:=====Excel文件../excel/pm/20110719/数据完整性-20110719_231102.xls开始创建=====
[2011-07-19 23:11:06][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-pm.xml:-----GSM-参数数据条数统计 生成开始-----
[2011-07-19 23:11:06][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-pm.xml:GSM-参数数据条数统计 sql: select 
		t2.start_time 时间,
		t1.vendor_name 厂商,
		t1.bsc_count BSC理论数量,
		t0.bsc_real_count BSC实际数量,
		round(nvl(t0.bsc_real_count,0)/t1.bsc_count*100,2)||'%' BSC数据完整率,
		t1.cell_count 小区理论数量,
		t0.cell_real_count 小区实际数量,
		round(nvl(t0.cell_real_count,0)/t1.cell_count*100,2)||'%' 小区数据完整率
		from 
		(select count(distinct bsc_name) bsc_count,count(*) cell_count,vendor_name from cm.f_g_c_cell  where state='入网在用' group by vendor_name) 
		t1
		left join
		(
		select trunc(sysdate) start_time from dual
		union
		select trunc(sysdate-1) start_time from dual
		union
		select trunc(sysdate-2) start_time from dual
		union
		select trunc(sysdate-3) start_time from dual
		union
		select trunc(sysdate-4) start_time from dual
		) t2
		on 1=1
		left join
		(
		select start_time,'爱立信' vendor_name,count(distinct bsc) bsc_real_count,count(*) cell_real_count from cm.g_e_c_internal_cell where start_time>sysdate-5 and cell not like 'B%' and cell not like '%TEST%' group by start_time
		union
		select start_time,'华为' vendor_name,count(distinct lac) bsc_real_count,count(*) cell_real_count from cm.g_h_c_cell where start_time>sysdate-5 and cell_uk not like 'B%' and cell_uk not like '%TEST%' group by start_time
		union
		select start_time,'诺基亚' vendor_name,count(distinct bsc_uk) bsc_real_count,count(*) cell_real_count from cm.g_n_c_bts where start_time>sysdate-5 and cell_uk not like 'B%' and cell_uk not like '%TEST%' group by start_time)
		t0
		on t0.start_time=t2.start_time and t1.vendor_name=t0.vendor_name
		order by 1 desc,2
[2011-07-19 23:11:12][com.inspur.db2excel.Main.oneTable2Excel(Main.java:210)][INFO][main]-pm.xml:GSM-参数数据条数统计 共保存了15条记录
[2011-07-19 23:11:12][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-pm.xml:-----GSM-参数数据条数统计 生成完成-----
[2011-07-19 23:11:12][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-pm.xml:-----TD-参数数据条数统计 生成开始-----
[2011-07-19 23:11:12][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-pm.xml:TD-参数数据条数统计 sql: select
		t2.start_time 时间,
		t1.vendor_name 厂商,
		nvl(t0.rnc_real_count,0) RNC实际数,
		t1.rnc_count RNC理论数,
		round(nvl(t0.rnc_real_count,0)/t1.rnc_count*100,2)||'%' RNC数据完整率,
		nvl(t0.utrancell_real_count,0) 小区实际数,
		t1.utrancell_count 小区理论数,
		round(nvl(t0.utrancell_real_count,0)/t1.utrancell_count*100,2)||'%' 小区数据完整率
		from 
		(select vendor_name,count(distinct rnc_uk) rnc_count,count(*) utrancell_count from cm.f_t_c_utrancell where status='入网在用' group by vendor_name) 
		t1
		left join
		(
		select trunc(sysdate+1) start_time from dual
		union
		select trunc(sysdate) start_time from dual
		union
		select trunc(sysdate-1) start_time from dual
		) t2
		on 1=1
		left join
		(
		select '中兴' vendor_name,count(distinct rnc_name) rnc_real_count,count(*) utrancell_real_count,start_time from cm.o_t_z_utrancell where start_time>sysdate-3 group by start_time
		union
		select '华为' vendor_name,count(distinct rnc_name) rnc_real_count,count(*) utrancell_real_count,start_time from cm.o_t_h_utrancell where start_time>sysdate-3 group by start_time
		union
		select '大唐' vendor_name,count(distinct rnc_name) rnc_real_count,count(*) utrancell_real_count,start_time from cm.o_t_d_utrancell where start_time>sysdate-3 group by start_time
		union
		select '烽火' vendor_name,count(distinct rnc_name) rnc_real_count,count(*) utrancell_real_count,start_time from cm.o_t_f_utrancell where start_time>sysdate-3 group by start_time
		) t0
		on t0.vendor_name=t1.vendor_name and t0.start_time=t2.start_time
		order by 1 desc,2
[2011-07-19 23:11:14][com.inspur.db2excel.Main.oneTable2Excel(Main.java:210)][INFO][main]-pm.xml:TD-参数数据条数统计 共保存了15条记录
[2011-07-19 23:11:14][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-pm.xml:-----TD-参数数据条数统计 生成完成-----
[2011-07-19 23:11:14][com.inspur.db2excel.Main.db2excel(Main.java:117)][INFO][main]-pm.xml:=====Excel文件../excel/pm/20110719/数据完整性-20110719_231102.xls保存完成=====
[2011-07-19 23:12:01][com.inspur.db2excel.Main.db2excel(Main.java:94)][INFO][main]-pm.xml:=====Excel文件../excel/pm/20110719/数据完整性-20110719_231201.xls开始创建=====
[2011-07-19 23:12:02][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-pm.xml:-----GSM-参数数据条数统计 生成开始-----
[2011-07-19 23:12:02][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-pm.xml:GSM-参数数据条数统计 sql: select 
		t2.start_time 时间,
		t1.vendor_name 厂商,
		t1.bsc_count BSC理论数量,
		t0.bsc_real_count BSC实际数量,
		round(nvl(t0.bsc_real_count,0)/t1.bsc_count*100,2)||'%' BSC数据完整率,
		t1.cell_count 小区理论数量,
		t0.cell_real_count 小区实际数量,
		round(nvl(t0.cell_real_count,0)/t1.cell_count*100,2)||'%' 小区数据完整率
		from 
		(select count(distinct bsc_name) bsc_count,count(*) cell_count,vendor_name from cm.f_g_c_cell  where state='入网在用' group by vendor_name) 
		t1
		left join
		(
		select trunc(sysdate) start_time from dual
		union
		select trunc(sysdate-1) start_time from dual
		union
		select trunc(sysdate-2) start_time from dual
		union
		select trunc(sysdate-3) start_time from dual
		union
		select trunc(sysdate-4) start_time from dual
		) t2
		on 1=1
		left join
		(
		select start_time,'爱立信' vendor_name,count(distinct bsc) bsc_real_count,count(*) cell_real_count from cm.g_e_c_internal_cell where start_time>sysdate-5 and cell not like 'B%' and cell not like '%TEST%' group by start_time
		union
		select start_time,'华为' vendor_name,count(distinct lac) bsc_real_count,count(*) cell_real_count from cm.g_h_c_cell where start_time>sysdate-5 and cell_uk not like 'B%' and cell_uk not like '%TEST%' group by start_time
		union
		select start_time,'诺基亚' vendor_name,count(distinct bsc_uk) bsc_real_count,count(*) cell_real_count from cm.g_n_c_bts where start_time>sysdate-5 and cell_uk not like 'B%' and cell_uk not like '%TEST%' group by start_time)
		t0
		on t0.start_time=t2.start_time and t1.vendor_name=t0.vendor_name
		order by 1 desc,2
[2011-07-19 23:12:10][com.inspur.db2excel.Main.oneTable2Excel(Main.java:210)][INFO][main]-pm.xml:GSM-参数数据条数统计 共保存了15条记录
[2011-07-19 23:12:10][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-pm.xml:-----GSM-参数数据条数统计 生成完成-----
[2011-07-19 23:12:10][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-pm.xml:-----TD-参数数据条数统计 生成开始-----
[2011-07-19 23:12:10][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-pm.xml:TD-参数数据条数统计 sql: select
		t2.start_time 时间,
		t1.vendor_name 厂商,
		nvl(t0.rnc_real_count,0) RNC实际数,
		t1.rnc_count RNC理论数,
		round(nvl(t0.rnc_real_count,0)/t1.rnc_count*100,2)||'%' RNC数据完整率,
		nvl(t0.utrancell_real_count,0) 小区实际数,
		t1.utrancell_count 小区理论数,
		round(nvl(t0.utrancell_real_count,0)/t1.utrancell_count*100,2)||'%' 小区数据完整率
		from 
		(select vendor_name,count(distinct rnc_uk) rnc_count,count(*) utrancell_count from cm.f_t_c_utrancell where status='入网在用' group by vendor_name) 
		t1
		left join
		(
		select trunc(sysdate+1) start_time from dual
		union
		select trunc(sysdate) start_time from dual
		union
		select trunc(sysdate-1) start_time from dual
		) t2
		on 1=1
		left join
		(
		select '中兴' vendor_name,count(distinct rnc_name) rnc_real_count,count(*) utrancell_real_count,start_time from cm.o_t_z_utrancell where start_time>sysdate-3 group by start_time
		union
		select '华为' vendor_name,count(distinct rnc_name) rnc_real_count,count(*) utrancell_real_count,start_time from cm.o_t_h_utrancell where start_time>sysdate-3 group by start_time
		union
		select '大唐' vendor_name,count(distinct rnc_name) rnc_real_count,count(*) utrancell_real_count,start_time from cm.o_t_d_utrancell where start_time>sysdate-3 group by start_time
		union
		select '烽火' vendor_name,count(distinct rnc_name) rnc_real_count,count(*) utrancell_real_count,start_time from cm.o_t_f_utrancell where start_time>sysdate-3 group by start_time
		) t0
		on t0.vendor_name=t1.vendor_name and t0.start_time=t2.start_time
		order by 1 desc,2
[2011-07-19 23:12:11][com.inspur.db2excel.Main.oneTable2Excel(Main.java:210)][INFO][main]-pm.xml:TD-参数数据条数统计 共保存了15条记录
[2011-07-19 23:12:11][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-pm.xml:-----TD-参数数据条数统计 生成完成-----
[2011-07-19 23:12:11][com.inspur.db2excel.Main.db2excel(Main.java:117)][INFO][main]-pm.xml:=====Excel文件../excel/pm/20110719/数据完整性-20110719_231201.xls保存完成=====
[2011-07-19 23:12:58][com.inspur.db2excel.Main.db2excel(Main.java:94)][INFO][main]-pm.xml:=====Excel文件../excel/pm/20110719/数据完整性-20110719_231258.xls开始创建=====
[2011-07-19 23:13:00][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-pm.xml:-----GSM-参数数据条数统计 生成开始-----
[2011-07-19 23:13:00][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-pm.xml:GSM-参数数据条数统计 sql: select 
		t2.start_time 时间,
		t1.vendor_name 厂商,
		t1.bsc_count BSC理论数量,
		t0.bsc_real_count BSC实际数量,
		round(nvl(t0.bsc_real_count,0)/t1.bsc_count*100,2)||'%' BSC数据完整率,
		t1.cell_count 小区理论数量,
		t0.cell_real_count 小区实际数量,
		round(nvl(t0.cell_real_count,0)/t1.cell_count*100,2)||'%' 小区数据完整率
		from 
		(select count(distinct bsc_name) bsc_count,count(*) cell_count,vendor_name from cm.f_g_c_cell  where state='入网在用' group by vendor_name) 
		t1
		left join
		(
		select trunc(sysdate) start_time from dual
		union
		select trunc(sysdate-1) start_time from dual
		union
		select trunc(sysdate-2) start_time from dual
		union
		select trunc(sysdate-3) start_time from dual
		union
		select trunc(sysdate-4) start_time from dual
		) t2
		on 1=1
		left join
		(
		select start_time,'爱立信' vendor_name,count(distinct bsc) bsc_real_count,count(*) cell_real_count from cm.g_e_c_internal_cell where start_time>sysdate-5 and cell not like 'B%' and cell not like '%TEST%' group by start_time
		union
		select start_time,'华为' vendor_name,count(distinct lac) bsc_real_count,count(*) cell_real_count from cm.g_h_c_cell where start_time>sysdate-5 and cell_uk not like 'B%' and cell_uk not like '%TEST%' group by start_time
		union
		select start_time,'诺基亚' vendor_name,count(distinct bsc_uk) bsc_real_count,count(*) cell_real_count from cm.g_n_c_bts where start_time>sysdate-5 and cell_uk not like 'B%' and cell_uk not like '%TEST%' group by start_time)
		t0
		on t0.start_time=t2.start_time and t1.vendor_name=t0.vendor_name
		order by 1 desc,2
[2011-07-19 23:13:07][com.inspur.db2excel.Main.oneTable2Excel(Main.java:216)][INFO][main]-pm.xml:GSM-参数数据条数统计 共保存了15条记录
[2011-07-19 23:13:07][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-pm.xml:-----GSM-参数数据条数统计 生成完成-----
[2011-07-19 23:13:07][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-pm.xml:-----TD-参数数据条数统计 生成开始-----
[2011-07-19 23:13:07][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-pm.xml:TD-参数数据条数统计 sql: select
		t2.start_time 时间,
		t1.vendor_name 厂商,
		nvl(t0.rnc_real_count,0) RNC实际数,
		t1.rnc_count RNC理论数,
		round(nvl(t0.rnc_real_count,0)/t1.rnc_count*100,2)||'%' RNC数据完整率,
		nvl(t0.utrancell_real_count,0) 小区实际数,
		t1.utrancell_count 小区理论数,
		round(nvl(t0.utrancell_real_count,0)/t1.utrancell_count*100,2)||'%' 小区数据完整率
		from 
		(select vendor_name,count(distinct rnc_uk) rnc_count,count(*) utrancell_count from cm.f_t_c_utrancell where status='入网在用' group by vendor_name) 
		t1
		left join
		(
		select trunc(sysdate+1) start_time from dual
		union
		select trunc(sysdate) start_time from dual
		union
		select trunc(sysdate-1) start_time from dual
		) t2
		on 1=1
		left join
		(
		select '中兴' vendor_name,count(distinct rnc_name) rnc_real_count,count(*) utrancell_real_count,start_time from cm.o_t_z_utrancell where start_time>sysdate-3 group by start_time
		union
		select '华为' vendor_name,count(distinct rnc_name) rnc_real_count,count(*) utrancell_real_count,start_time from cm.o_t_h_utrancell where start_time>sysdate-3 group by start_time
		union
		select '大唐' vendor_name,count(distinct rnc_name) rnc_real_count,count(*) utrancell_real_count,start_time from cm.o_t_d_utrancell where start_time>sysdate-3 group by start_time
		union
		select '烽火' vendor_name,count(distinct rnc_name) rnc_real_count,count(*) utrancell_real_count,start_time from cm.o_t_f_utrancell where start_time>sysdate-3 group by start_time
		) t0
		on t0.vendor_name=t1.vendor_name and t0.start_time=t2.start_time
		order by 1 desc,2
[2011-07-19 23:13:09][com.inspur.db2excel.Main.oneTable2Excel(Main.java:216)][INFO][main]-pm.xml:TD-参数数据条数统计 共保存了15条记录
[2011-07-19 23:13:09][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-pm.xml:-----TD-参数数据条数统计 生成完成-----
[2011-07-19 23:13:09][com.inspur.db2excel.Main.db2excel(Main.java:117)][INFO][main]-pm.xml:=====Excel文件../excel/pm/20110719/数据完整性-20110719_231258.xls保存完成=====
[2011-07-19 23:14:08][com.inspur.db2excel.Main.db2excel(Main.java:94)][INFO][main]-pm.xml:=====Excel文件../excel/pm/20110719/数据完整性-20110719_231408.xls开始创建=====
[2011-07-19 23:14:09][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-pm.xml:-----GSM-归一化性能数据条数统计 生成开始-----
[2011-07-19 23:14:09][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-pm.xml:GSM-归一化性能数据条数统计 sql: select 
			sysdate 检测时间,
			'山东' 省份,
			to_char(t2.time,'yyyy-mm-dd hh24') 指标时间,
			t3.vendor_name 厂商,
			t3.bsc_count 理论BSC数,
			t0.bsc_count_real 实际BSC数,
			t1.bsc_count_real 数据正常BSC数,
			round(nvl(t1.bsc_count_real,0)/t3.bsc_count*100,2)||'%' BSC数据完整率,
			t3.cell_count 理论小区数,
			t0.cell_count_real 实际小区数,
			t1.cell_count_real 数据正常小区数,
			round(nvl(t1.cell_count_real,0)/t3.cell_count*100,2) ||'%' 小区数据完整率
		from time_list t2
		left join
		(
			select vendor_name,count(distinct bsc_uk) bsc_count,count(*) cell_count from cm.f_g_c_cell 
			where bsc_uk is not null and state='入网在用' group by vendor_name	
		) t3
		on 1=1
		left join
		(	select 
				start_time,
				vendor_name,
				count(distinct bsc_uk) bsc_count_real,
				count(*) cell_count_real
			from pm.f_g_c_cell_hour
			where start_time>=sysdate-12/24
			group by start_time,vendor_name) t0
		on t0.vendor_name=t3.vendor_name and t0.start_time=t2.time 
		left join
		(	select 
				start_time,
				vendor_name,
				count(distinct bsc_uk) bsc_count_real,
				count(*) cell_count_real
			from pm.f_g_c_cell_hour
			where start_time>=sysdate-12/24 and bsche00 is not null
			group by start_time,vendor_name) t1
		on t1.vendor_name=t3.vendor_name and t1.start_time=t2.time
		where t2.time>=sysdate-12/24 and t2.time<sysdate-3/24
		order by 4,3
[2011-07-19 23:14:20][com.inspur.db2excel.Main.oneTable2Excel(Main.java:216)][INFO][main]-pm.xml:GSM-归一化性能数据条数统计 共保存了27条记录
[2011-07-19 23:14:20][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-pm.xml:-----GSM-归一化性能数据条数统计 生成完成-----
[2011-07-19 23:14:20][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-pm.xml:-----GSM-爱立信-原始CONTER数据条数统计 生成开始-----
[2011-07-19 23:14:20][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-pm.xml:GSM-爱立信-原始CONTER数据条数统计 sql: select 
        to_char(sysdate,'yyyy-mm-dd hh24:mi:ss') 检测时间,
        to_char(t2.time,'yyyy-mm-dd hh24') 指标时间,
        '爱立信' 厂商,
        t1.bsc_count 理论BSC数,
        nvl(t0.bsc_count,0) 实际BSC数,
        t1.cell_count 理论小区数,
        nvl(t0.cell_count,0) 实际小区数,
        round(nvl(t0.cell_count,0)/t1.cell_count*100,2)||'%' 数据完整率
    from time_list t2
    left join
        (select count(distinct bsc_uk) bsc_count,count(*) cell_count from cm.f_g_c_cell 
        where vendor_uk=1 and bsc_uk is not null and state='入网在用') t1 
    on 1=1
    left join
        (select  start_time,count(distinct bsc_uk) bsc_count,count(*) cell_count from pm.o_g_e_r12_h_celtchf 
        where    start_time >=sysdate-1
        group by start_time ) t0
    on t2.time=t0.start_time
        where 
        t2.time>=sysdate-1 and t2.time<sysdate-3/24
        order by 2
[2011-07-19 23:15:24][com.inspur.db2excel.Main.oneTable2Excel(Main.java:216)][INFO][main]-pm.xml:GSM-爱立信-原始CONTER数据条数统计 共保存了21条记录
[2011-07-19 23:15:24][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-pm.xml:-----GSM-爱立信-原始CONTER数据条数统计 生成完成-----
[2011-07-19 23:15:24][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-pm.xml:-----GSM-诺基亚-原始CONTER数据条数统计 生成开始-----
[2011-07-19 23:15:24][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-pm.xml:GSM-诺基亚-原始CONTER数据条数统计 sql: select 
        to_char(sysdate,'yyyy-mm-dd hh24:mi:ss') 检测时间,
        to_char(t2.time,'yyyy-mm-dd hh24') 指标时间,
        '诺基亚' 厂商,
        t1.bsc_count 理论BSC数,
        nvl(t0.bsc_count,0) 实际BSC数,
        t1.cell_count 理论小区数,
        nvl(t0.cell_count,0) 实际小区数,
        round(nvl(t0.cell_count,0)/t1.cell_count*100,2)||'%' 数据完整率
    from time_list t2
    left join
        (select count(distinct bsc_uk) bsc_count,count(*) cell_count from cm.f_g_c_cell 
        where vendor_uk=15 and bsc_uk is not null and state='入网在用') t1 
    on 1=1
    left join
        (select  start_time,count(distinct bsc_uk) bsc_count,count(*) cell_count from pm.o_g_n_s14_h_traffic  
        where    start_time >=sysdate-1
        group by start_time ) t0
    on t2.time=t0.start_time
        where 
        t2.time>=sysdate-1 and t2.time<sysdate-3/24
        order by 2
[2011-07-19 23:15:45][com.inspur.db2excel.Main.oneTable2Excel(Main.java:216)][INFO][main]-pm.xml:GSM-诺基亚-原始CONTER数据条数统计 共保存了21条记录
[2011-07-19 23:15:45][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-pm.xml:-----GSM-诺基亚-原始CONTER数据条数统计 生成完成-----
[2011-07-19 23:15:45][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-pm.xml:-----GSM-华为-原始CONTER数据条数统计 生成开始-----
[2011-07-19 23:15:45][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-pm.xml:GSM-华为-原始CONTER数据条数统计 sql: select 
        to_char(sysdate,'yyyy-mm-dd hh24:mi:ss') 检测时间,
        to_char(t2.time,'yyyy-mm-dd hh24') 指标时间,
        '华为' 厂商,
        t1.bsc_count 理论BSC数,
        nvl(t0.bsc_count,0) 实际BSC数,
        t1.cell_count 理论小区数,
        nvl(t0.cell_count,0) 实际小区数,
        round(nvl(t0.cell_count,0)/t1.cell_count*100,2)||'%' 数据完整率
    from time_list t2
    left join
        (select count(distinct bsc_uk) bsc_count,count(*) cell_count from cm.f_g_c_cell 
        where vendor_uk=5 and bsc_uk is not null and state='入网在用') t1 
    on 1=1
    left join
        (select  start_time,count(distinct bsc_uk) bsc_count,count(*) cell_count from pm.O_G_H_R11_1275071420_3  
        where    start_time >=sysdate-1
        group by start_time ) t0
    on t2.time=t0.start_time
        where 
        t2.time>=sysdate-1 and t2.time<sysdate-3/24
        order by 2
[2011-07-19 23:16:05][com.inspur.db2excel.Main.oneTable2Excel(Main.java:216)][INFO][main]-pm.xml:GSM-华为-原始CONTER数据条数统计 共保存了21条记录
[2011-07-19 23:16:05][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-pm.xml:-----GSM-华为-原始CONTER数据条数统计 生成完成-----
[2011-07-19 23:16:05][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-pm.xml:-----GSM-参数数据条数统计 生成开始-----
[2011-07-19 23:16:05][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-pm.xml:GSM-参数数据条数统计 sql: select 
		t2.start_time 时间,
		t1.vendor_name 厂商,
		t1.bsc_count BSC理论数量,
		t0.bsc_real_count BSC实际数量,
		round(nvl(t0.bsc_real_count,0)/t1.bsc_count*100,2)||'%' BSC数据完整率,
		t1.cell_count 小区理论数量,
		t0.cell_real_count 小区实际数量,
		round(nvl(t0.cell_real_count,0)/t1.cell_count*100,2)||'%' 小区数据完整率
		from 
		(select count(distinct bsc_name) bsc_count,count(*) cell_count,vendor_name from cm.f_g_c_cell  where state='入网在用' group by vendor_name) 
		t1
		left join
		(
		select trunc(sysdate) start_time from dual
		union
		select trunc(sysdate-1) start_time from dual
		union
		select trunc(sysdate-2) start_time from dual
		union
		select trunc(sysdate-3) start_time from dual
		union
		select trunc(sysdate-4) start_time from dual
		) t2
		on 1=1
		left join
		(
		select start_time,'爱立信' vendor_name,count(distinct bsc) bsc_real_count,count(*) cell_real_count from cm.g_e_c_internal_cell where start_time>sysdate-5 and cell not like 'B%' and cell not like '%TEST%' group by start_time
		union
		select start_time,'华为' vendor_name,count(distinct lac) bsc_real_count,count(*) cell_real_count from cm.g_h_c_cell where start_time>sysdate-5 and cell_uk not like 'B%' and cell_uk not like '%TEST%' group by start_time
		union
		select start_time,'诺基亚' vendor_name,count(distinct bsc_uk) bsc_real_count,count(*) cell_real_count from cm.g_n_c_bts where start_time>sysdate-5 and cell_uk not like 'B%' and cell_uk not like '%TEST%' group by start_time)
		t0
		on t0.start_time=t2.start_time and t1.vendor_name=t0.vendor_name
		order by 1 desc,2
[2011-07-19 23:16:12][com.inspur.db2excel.Main.oneTable2Excel(Main.java:216)][INFO][main]-pm.xml:GSM-参数数据条数统计 共保存了15条记录
[2011-07-19 23:16:12][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-pm.xml:-----GSM-参数数据条数统计 生成完成-----
[2011-07-19 23:16:12][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-pm.xml:-----TD-参数数据条数统计 生成开始-----
[2011-07-19 23:16:12][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-pm.xml:TD-参数数据条数统计 sql: select
		t2.start_time 时间,
		t1.vendor_name 厂商,
		nvl(t0.rnc_real_count,0) RNC实际数,
		t1.rnc_count RNC理论数,
		round(nvl(t0.rnc_real_count,0)/t1.rnc_count*100,2)||'%' RNC数据完整率,
		nvl(t0.utrancell_real_count,0) 小区实际数,
		t1.utrancell_count 小区理论数,
		round(nvl(t0.utrancell_real_count,0)/t1.utrancell_count*100,2)||'%' 小区数据完整率
		from 
		(select vendor_name,count(distinct rnc_uk) rnc_count,count(*) utrancell_count from cm.f_t_c_utrancell where status='入网在用' group by vendor_name) 
		t1
		left join
		(
		select trunc(sysdate+1) start_time from dual
		union
		select trunc(sysdate) start_time from dual
		union
		select trunc(sysdate-1) start_time from dual
		) t2
		on 1=1
		left join
		(
		select '中兴' vendor_name,count(distinct rnc_name) rnc_real_count,count(*) utrancell_real_count,start_time from cm.o_t_z_utrancell where start_time>sysdate-3 group by start_time
		union
		select '华为' vendor_name,count(distinct rnc_name) rnc_real_count,count(*) utrancell_real_count,start_time from cm.o_t_h_utrancell where start_time>sysdate-3 group by start_time
		union
		select '大唐' vendor_name,count(distinct rnc_name) rnc_real_count,count(*) utrancell_real_count,start_time from cm.o_t_d_utrancell where start_time>sysdate-3 group by start_time
		union
		select '烽火' vendor_name,count(distinct rnc_name) rnc_real_count,count(*) utrancell_real_count,start_time from cm.o_t_f_utrancell where start_time>sysdate-3 group by start_time
		) t0
		on t0.vendor_name=t1.vendor_name and t0.start_time=t2.start_time
		order by 1 desc,2
[2011-07-19 23:16:13][com.inspur.db2excel.Main.oneTable2Excel(Main.java:216)][INFO][main]-pm.xml:TD-参数数据条数统计 共保存了15条记录
[2011-07-19 23:16:13][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-pm.xml:-----TD-参数数据条数统计 生成完成-----
[2011-07-19 23:16:13][com.inspur.db2excel.Main.db2excel(Main.java:117)][INFO][main]-pm.xml:=====Excel文件../excel/pm/20110719/数据完整性-20110719_231408.xls保存完成=====
[2011-07-19 23:17:36][com.inspur.db2excel.Main.db2excel(Main.java:94)][INFO][main]-pm.xml:=====Excel文件../excel/pm/20110719/数据完整性-20110719_231736.xls开始创建=====
[2011-07-19 23:17:38][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-pm.xml:-----GSM-归一化性能数据条数统计 生成开始-----
[2011-07-19 23:17:38][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-pm.xml:GSM-归一化性能数据条数统计 sql: select 
			sysdate 检测时间,
			'山东' 省份,
			to_char(t2.time,'yyyy-mm-dd hh24') 指标时间,
			t3.vendor_name 厂商,
			t3.bsc_count 理论BSC数,
			t0.bsc_count_real 实际BSC数,
			t1.bsc_count_real 数据正常BSC数,
			round(nvl(t1.bsc_count_real,0)/t3.bsc_count*100,2)||'%' BSC数据完整率,
			t3.cell_count 理论小区数,
			t0.cell_count_real 实际小区数,
			t1.cell_count_real 数据正常小区数,
			round(nvl(t1.cell_count_real,0)/t3.cell_count*100,2) ||'%' 小区数据完整率
		from time_list t2
		left join
		(
			select vendor_name,count(distinct bsc_uk) bsc_count,count(*) cell_count from cm.f_g_c_cell 
			where bsc_uk is not null and state='入网在用' group by vendor_name	
		) t3
		on 1=1
		left join
		(	select 
				start_time,
				vendor_name,
				count(distinct bsc_uk) bsc_count_real,
				count(*) cell_count_real
			from pm.f_g_c_cell_hour
			where start_time>=sysdate-16/24
			group by start_time,vendor_name) t0
		on t0.vendor_name=t3.vendor_name and t0.start_time=t2.time 
		left join
		(	select 
				start_time,
				vendor_name,
				count(distinct bsc_uk) bsc_count_real,
				count(*) cell_count_real
			from pm.f_g_c_cell_hour
			where start_time>=sysdate-16/24 and bsche00 is not null
			group by start_time,vendor_name) t1
		on t1.vendor_name=t3.vendor_name and t1.start_time=t2.time
		where t2.time>=sysdate-16/24 and t2.time<sysdate-4/24
		order by 4,3
[2011-07-19 23:19:01][com.inspur.db2excel.Main.oneTable2Excel(Main.java:216)][INFO][main]-pm.xml:GSM-归一化性能数据条数统计 共保存了36条记录
[2011-07-19 23:19:01][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-pm.xml:-----GSM-归一化性能数据条数统计 生成完成-----
[2011-07-19 23:19:01][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-pm.xml:-----GSM-爱立信-原始CONTER数据条数统计 生成开始-----
[2011-07-19 23:19:01][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-pm.xml:GSM-爱立信-原始CONTER数据条数统计 sql: select 
        to_char(sysdate,'yyyy-mm-dd hh24:mi:ss') 检测时间,
        to_char(t2.time,'yyyy-mm-dd hh24') 指标时间,
        '爱立信' 厂商,
        t1.bsc_count 理论BSC数,
        nvl(t0.bsc_count,0) 实际BSC数,
        t1.cell_count 理论小区数,
        nvl(t0.cell_count,0) 实际小区数,
        round(nvl(t0.cell_count,0)/t1.cell_count*100,2)||'%' 数据完整率
    from time_list t2
    left join
        (select count(distinct bsc_uk) bsc_count,count(*) cell_count from cm.f_g_c_cell 
        where vendor_uk=1 and bsc_uk is not null and state='入网在用') t1 
    on 1=1
    left join
        (select  start_time,count(distinct bsc_uk) bsc_count,count(*) cell_count from pm.o_g_e_r12_h_celtchf 
        where    start_time >=sysdate-1
        group by start_time ) t0
    on t2.time=t0.start_time
        where 
        t2.time>=sysdate-1 and t2.time<sysdate-3/24
        order by 2
[2011-07-19 23:20:04][com.inspur.db2excel.Main.oneTable2Excel(Main.java:216)][INFO][main]-pm.xml:GSM-爱立信-原始CONTER数据条数统计 共保存了21条记录
[2011-07-19 23:20:04][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-pm.xml:-----GSM-爱立信-原始CONTER数据条数统计 生成完成-----
[2011-07-19 23:20:04][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-pm.xml:-----GSM-诺基亚-原始CONTER数据条数统计 生成开始-----
[2011-07-19 23:20:04][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-pm.xml:GSM-诺基亚-原始CONTER数据条数统计 sql: select 
        to_char(sysdate,'yyyy-mm-dd hh24:mi:ss') 检测时间,
        to_char(t2.time,'yyyy-mm-dd hh24') 指标时间,
        '诺基亚' 厂商,
        t1.bsc_count 理论BSC数,
        nvl(t0.bsc_count,0) 实际BSC数,
        t1.cell_count 理论小区数,
        nvl(t0.cell_count,0) 实际小区数,
        round(nvl(t0.cell_count,0)/t1.cell_count*100,2)||'%' 数据完整率
    from time_list t2
    left join
        (select count(distinct bsc_uk) bsc_count,count(*) cell_count from cm.f_g_c_cell 
        where vendor_uk=15 and bsc_uk is not null and state='入网在用') t1 
    on 1=1
    left join
        (select  start_time,count(distinct bsc_uk) bsc_count,count(*) cell_count from pm.o_g_n_s14_h_traffic  
        where    start_time >=sysdate-1
        group by start_time ) t0
    on t2.time=t0.start_time
        where 
        t2.time>=sysdate-1 and t2.time<sysdate-3/24
        order by 2
[2011-07-19 23:20:10][com.inspur.db2excel.Main.oneTable2Excel(Main.java:216)][INFO][main]-pm.xml:GSM-诺基亚-原始CONTER数据条数统计 共保存了21条记录
[2011-07-19 23:20:10][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-pm.xml:-----GSM-诺基亚-原始CONTER数据条数统计 生成完成-----
[2011-07-19 23:20:10][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-pm.xml:-----GSM-华为-原始CONTER数据条数统计 生成开始-----
[2011-07-19 23:20:10][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-pm.xml:GSM-华为-原始CONTER数据条数统计 sql: select 
        to_char(sysdate,'yyyy-mm-dd hh24:mi:ss') 检测时间,
        to_char(t2.time,'yyyy-mm-dd hh24') 指标时间,
        '华为' 厂商,
        t1.bsc_count 理论BSC数,
        nvl(t0.bsc_count,0) 实际BSC数,
        t1.cell_count 理论小区数,
        nvl(t0.cell_count,0) 实际小区数,
        round(nvl(t0.cell_count,0)/t1.cell_count*100,2)||'%' 数据完整率
    from time_list t2
    left join
        (select count(distinct bsc_uk) bsc_count,count(*) cell_count from cm.f_g_c_cell 
        where vendor_uk=5 and bsc_uk is not null and state='入网在用') t1 
    on 1=1
    left join
        (select  start_time,count(distinct bsc_uk) bsc_count,count(*) cell_count from pm.O_G_H_R11_1275071420_3  
        where    start_time >=sysdate-1
        group by start_time ) t0
    on t2.time=t0.start_time
        where 
        t2.time>=sysdate-1 and t2.time<sysdate-3/24
        order by 2
[2011-07-19 23:20:18][com.inspur.db2excel.Main.oneTable2Excel(Main.java:216)][INFO][main]-pm.xml:GSM-华为-原始CONTER数据条数统计 共保存了21条记录
[2011-07-19 23:20:18][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-pm.xml:-----GSM-华为-原始CONTER数据条数统计 生成完成-----
[2011-07-19 23:20:18][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-pm.xml:-----GSM-参数数据条数统计 生成开始-----
[2011-07-19 23:20:18][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-pm.xml:GSM-参数数据条数统计 sql: select 
		t2.start_time 时间,
		t1.vendor_name 厂商,
		t1.bsc_count BSC理论数量,
		t0.bsc_real_count BSC实际数量,
		round(nvl(t0.bsc_real_count,0)/t1.bsc_count*100,2)||'%' BSC数据完整率,
		t1.cell_count 小区理论数量,
		t0.cell_real_count 小区实际数量,
		round(nvl(t0.cell_real_count,0)/t1.cell_count*100,2)||'%' 小区数据完整率
		from 
		(select count(distinct bsc_name) bsc_count,count(*) cell_count,vendor_name from cm.f_g_c_cell  where state='入网在用' group by vendor_name) 
		t1
		left join
		(
		select trunc(sysdate) start_time from dual
		union
		select trunc(sysdate-1) start_time from dual
		union
		select trunc(sysdate-2) start_time from dual
		union
		select trunc(sysdate-3) start_time from dual
		union
		select trunc(sysdate-4) start_time from dual
		) t2
		on 1=1
		left join
		(
		select start_time,'爱立信' vendor_name,count(distinct bsc) bsc_real_count,count(*) cell_real_count from cm.g_e_c_internal_cell where start_time>sysdate-5 and cell not like 'B%' and cell not like '%TEST%' group by start_time
		union
		select start_time,'华为' vendor_name,count(distinct lac) bsc_real_count,count(*) cell_real_count from cm.g_h_c_cell where start_time>sysdate-5 and cell_uk not like 'B%' and cell_uk not like '%TEST%' group by start_time
		union
		select start_time,'诺基亚' vendor_name,count(distinct bsc_uk) bsc_real_count,count(*) cell_real_count from cm.g_n_c_bts where start_time>sysdate-5 and cell_uk not like 'B%' and cell_uk not like '%TEST%' group by start_time)
		t0
		on t0.start_time=t2.start_time and t1.vendor_name=t0.vendor_name
		order by 1 desc,2
[2011-07-19 23:20:27][com.inspur.db2excel.Main.oneTable2Excel(Main.java:216)][INFO][main]-pm.xml:GSM-参数数据条数统计 共保存了15条记录
[2011-07-19 23:20:27][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-pm.xml:-----GSM-参数数据条数统计 生成完成-----
[2011-07-19 23:20:27][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-pm.xml:-----TD-参数数据条数统计 生成开始-----
[2011-07-19 23:20:27][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-pm.xml:TD-参数数据条数统计 sql: select
		t2.start_time 时间,
		t1.vendor_name 厂商,
		nvl(t0.rnc_real_count,0) RNC实际数,
		t1.rnc_count RNC理论数,
		round(nvl(t0.rnc_real_count,0)/t1.rnc_count*100,2)||'%' RNC数据完整率,
		nvl(t0.utrancell_real_count,0) 小区实际数,
		t1.utrancell_count 小区理论数,
		round(nvl(t0.utrancell_real_count,0)/t1.utrancell_count*100,2)||'%' 小区数据完整率
		from 
		(select vendor_name,count(distinct rnc_uk) rnc_count,count(*) utrancell_count from cm.f_t_c_utrancell where status='入网在用' group by vendor_name) 
		t1
		left join
		(
		select trunc(sysdate+1) start_time from dual
		union
		select trunc(sysdate) start_time from dual
		union
		select trunc(sysdate-1) start_time from dual
		) t2
		on 1=1
		left join
		(
		select '中兴' vendor_name,count(distinct rnc_name) rnc_real_count,count(*) utrancell_real_count,start_time from cm.o_t_z_utrancell where start_time>sysdate-3 group by start_time
		union
		select '华为' vendor_name,count(distinct rnc_name) rnc_real_count,count(*) utrancell_real_count,start_time from cm.o_t_h_utrancell where start_time>sysdate-3 group by start_time
		union
		select '大唐' vendor_name,count(distinct rnc_name) rnc_real_count,count(*) utrancell_real_count,start_time from cm.o_t_d_utrancell where start_time>sysdate-3 group by start_time
		union
		select '烽火' vendor_name,count(distinct rnc_name) rnc_real_count,count(*) utrancell_real_count,start_time from cm.o_t_f_utrancell where start_time>sysdate-3 group by start_time
		) t0
		on t0.vendor_name=t1.vendor_name and t0.start_time=t2.start_time
		order by 1 desc,2
[2011-07-19 23:20:29][com.inspur.db2excel.Main.oneTable2Excel(Main.java:216)][INFO][main]-pm.xml:TD-参数数据条数统计 共保存了15条记录
[2011-07-19 23:20:29][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-pm.xml:-----TD-参数数据条数统计 生成完成-----
[2011-07-19 23:20:29][com.inspur.db2excel.Main.db2excel(Main.java:117)][INFO][main]-pm.xml:=====Excel文件../excel/pm/20110719/数据完整性-20110719_231736.xls保存完成=====
[2011-07-19 23:32:56][com.inspur.db2excel.Main.db2excel(Main.java:94)][INFO][main]-pm.xml:=====Excel文件../excel/pm/20110719/数据完整性-20110719_233256.xls开始创建=====
[2011-07-19 23:32:57][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-pm.xml:-----GSM-性能-归一化数据条数统计 生成开始-----
[2011-07-19 23:32:57][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-pm.xml:GSM-性能-归一化数据条数统计 sql: select 
			sysdate 检测时间,
			'山东' 省份,
			to_char(t2.time,'yyyy-mm-dd hh24') 指标时间,
			t3.vendor_name 厂商,
			t3.bsc_count 理论BSC数,
			t0.bsc_count_real 实际BSC数,
			t1.bsc_count_real 数据正常BSC数,
			round(nvl(t1.bsc_count_real,0)/t3.bsc_count*100,2)||'%' BSC数据完整率,
			t3.cell_count 理论小区数,
			t0.cell_count_real 实际小区数,
			t1.cell_count_real 数据正常小区数,
			round(nvl(t1.cell_count_real,0)/t3.cell_count*100,2) ||'%' 小区数据完整率
		from time_list t2
		left join
		(
			select vendor_name,count(distinct bsc_uk) bsc_count,count(*) cell_count from cm.f_g_c_cell 
			where bsc_uk is not null and state='入网在用' group by vendor_name	
		) t3
		on 1=1
		left join
		(	select 
				start_time,
				vendor_name,
				count(distinct bsc_uk) bsc_count_real,
				count(*) cell_count_real
			from pm.f_g_c_cell_hour
			where start_time>=sysdate-16/24
			group by start_time,vendor_name) t0
		on t0.vendor_name=t3.vendor_name and t0.start_time=t2.time 
		left join
		(	select 
				start_time,
				vendor_name,
				count(distinct bsc_uk) bsc_count_real,
				count(*) cell_count_real
			from pm.f_g_c_cell_hour
			where start_time>=sysdate-16/24 and bsche00 is not null
			group by start_time,vendor_name) t1
		on t1.vendor_name=t3.vendor_name and t1.start_time=t2.time
		where t2.time>=sysdate-1-4/24 and t2.time<sysdate-4/24
		order by 4,3
[2011-07-19 23:33:27][com.inspur.db2excel.Main.oneTable2Excel(Main.java:216)][INFO][main]-pm.xml:GSM-性能-归一化数据条数统计 共保存了72条记录
[2011-07-19 23:33:27][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-pm.xml:-----GSM-性能-归一化数据条数统计 生成完成-----
[2011-07-19 23:33:27][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-pm.xml:-----GSM-性能-原始CONTER数据条数统计 生成开始-----
[2011-07-19 23:33:27][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-pm.xml:GSM-性能-原始CONTER数据条数统计 sql: select 
        to_char(sysdate,'yyyy-mm-dd hh24:mi:ss') 检测时间,
        to_char(t2.time,'yyyy-mm-dd hh24') 指标时间,
        t1.vendor_name 厂商,
        t1.bsc_count 理论BSC数,
        nvl(t0.bsc_count,0) 实际BSC数,
        round(nvl(t0.bsc_count,0)/t1.bsc_count*100,2)||'%' BSC数据完整率,
        t1.cell_count 理论小区数,
        nvl(t0.cell_count,0) 实际小区数,
        round(nvl(t0.cell_count,0)/t1.cell_count*100,2)||'%' 小区数据完整率
    from time_list t2
    left join
        (select vendor_name,count(distinct bsc_uk) bsc_count,count(*) cell_count from cm.f_g_c_cell 
        where bsc_uk is not null and state='入网在用' group by vendor_name) t1 
    on 1=1
    left join
        (
        select  '诺基亚' vendor_name,start_time,count(distinct bsc_uk) bsc_count,count(*) cell_count from pm.o_g_n_s14_h_traffic    where start_time >=sysdate-1 group by start_time
        union
        select  '华为' vendor_name,start_time,count(distinct bsc_uk) bsc_count,count(*) cell_count from pm.O_G_H_R11_1275071420_3 where start_time >=sysdate-1 group by start_time 
        union
        select  '爱立信' vendor_name,start_time,count(distinct bsc_uk) bsc_count,count(*) cell_count from pm.o_g_e_r12_h_celtchf    where start_time >=sysdate-1 group by start_time 
        ) t0
    on t2.time=t0.start_time and t0.vendor_name=t1.vendor_name
        where 
        t2.time>=sysdate-1-3/24 and t2.time<sysdate-3/24
        order by 3,2
[2011-07-19 23:34:53][com.inspur.db2excel.Main.oneTable2Excel(Main.java:216)][INFO][main]-pm.xml:GSM-性能-原始CONTER数据条数统计 共保存了72条记录
[2011-07-19 23:34:53][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-pm.xml:-----GSM-性能-原始CONTER数据条数统计 生成完成-----
[2011-07-19 23:34:53][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-pm.xml:-----GSM-参数数据条数统计 生成开始-----
[2011-07-19 23:34:53][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-pm.xml:GSM-参数数据条数统计 sql: select 
		t2.start_time 时间,
		t1.vendor_name 厂商,
		t1.bsc_count BSC理论数量,
		t0.bsc_real_count BSC实际数量,
		round(nvl(t0.bsc_real_count,0)/t1.bsc_count*100,2)||'%' BSC数据完整率,
		t1.cell_count 小区理论数量,
		t0.cell_real_count 小区实际数量,
		round(nvl(t0.cell_real_count,0)/t1.cell_count*100,2)||'%' 小区数据完整率
		from 
		(select count(distinct bsc_name) bsc_count,count(*) cell_count,vendor_name from cm.f_g_c_cell  where state='入网在用' group by vendor_name) 
		t1
		left join
		(
		select trunc(sysdate) start_time from dual
		union
		select trunc(sysdate-1) start_time from dual
		union
		select trunc(sysdate-2) start_time from dual
		union
		select trunc(sysdate-3) start_time from dual
		union
		select trunc(sysdate-4) start_time from dual
		) t2
		on 1=1
		left join
		(
		select start_time,'爱立信' vendor_name,count(distinct bsc) bsc_real_count,count(*) cell_real_count from cm.g_e_c_internal_cell where start_time>sysdate-5 and cell not like 'B%' and cell not like '%TEST%' group by start_time
		union
		select start_time,'华为' vendor_name,count(distinct lac) bsc_real_count,count(*) cell_real_count from cm.g_h_c_cell where start_time>sysdate-5 and cell_uk not like 'B%' and cell_uk not like '%TEST%' group by start_time
		union
		select start_time,'诺基亚' vendor_name,count(distinct bsc_uk) bsc_real_count,count(*) cell_real_count from cm.g_n_c_bts where start_time>sysdate-5 and cell_uk not like 'B%' and cell_uk not like '%TEST%' group by start_time)
		t0
		on t0.start_time=t2.start_time and t1.vendor_name=t0.vendor_name
		order by 1 desc,2
[2011-07-19 23:35:05][com.inspur.db2excel.Main.oneTable2Excel(Main.java:216)][INFO][main]-pm.xml:GSM-参数数据条数统计 共保存了15条记录
[2011-07-19 23:35:05][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-pm.xml:-----GSM-参数数据条数统计 生成完成-----
[2011-07-19 23:35:05][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-pm.xml:-----TD-参数数据条数统计 生成开始-----
[2011-07-19 23:35:05][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-pm.xml:TD-参数数据条数统计 sql: select
		t2.start_time 时间,
		t1.vendor_name 厂商,
		nvl(t0.rnc_real_count,0) RNC实际数,
		t1.rnc_count RNC理论数,
		round(nvl(t0.rnc_real_count,0)/t1.rnc_count*100,2)||'%' RNC数据完整率,
		nvl(t0.utrancell_real_count,0) 小区实际数,
		t1.utrancell_count 小区理论数,
		round(nvl(t0.utrancell_real_count,0)/t1.utrancell_count*100,2)||'%' 小区数据完整率
		from 
		(select vendor_name,count(distinct rnc_uk) rnc_count,count(*) utrancell_count from cm.f_t_c_utrancell where status='入网在用' group by vendor_name) 
		t1
		left join
		(
		select trunc(sysdate+1) start_time from dual
		union
		select trunc(sysdate) start_time from dual
		union
		select trunc(sysdate-1) start_time from dual
		) t2
		on 1=1
		left join
		(
		select '中兴' vendor_name,count(distinct rnc_name) rnc_real_count,count(*) utrancell_real_count,start_time from cm.o_t_z_utrancell where start_time>sysdate-3 group by start_time
		union
		select '华为' vendor_name,count(distinct rnc_name) rnc_real_count,count(*) utrancell_real_count,start_time from cm.o_t_h_utrancell where start_time>sysdate-3 group by start_time
		union
		select '大唐' vendor_name,count(distinct rnc_name) rnc_real_count,count(*) utrancell_real_count,start_time from cm.o_t_d_utrancell where start_time>sysdate-3 group by start_time
		union
		select '烽火' vendor_name,count(distinct rnc_name) rnc_real_count,count(*) utrancell_real_count,start_time from cm.o_t_f_utrancell where start_time>sysdate-3 group by start_time
		) t0
		on t0.vendor_name=t1.vendor_name and t0.start_time=t2.start_time
		order by 1 desc,2
[2011-07-19 23:35:07][com.inspur.db2excel.Main.oneTable2Excel(Main.java:216)][INFO][main]-pm.xml:TD-参数数据条数统计 共保存了15条记录
[2011-07-19 23:35:07][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-pm.xml:-----TD-参数数据条数统计 生成完成-----
[2011-07-19 23:35:07][com.inspur.db2excel.Main.db2excel(Main.java:117)][INFO][main]-pm.xml:=====Excel文件../excel/pm/20110719/数据完整性-20110719_233256.xls保存完成=====
