[2011-07-21 18:40:20][com.inspur.db2excel.Main.db2excel(Main.java:94)][INFO][main]-day_report.xml:=====Excel文件../excel/DATA_QUARLITY/20110721/数据质量日报-20110721_184020.xls开始创建=====
[2011-07-21 18:41:38][com.inspur.db2excel.Main.db2excel(Main.java:94)][INFO][main]-day_report.xml:=====Excel文件../excel/DATA_QUARLITY/20110721/数据质量日报-20110721_184138.xls开始创建=====
[2011-07-21 18:43:05][com.inspur.db2excel.Main.db2excel(Main.java:94)][INFO][main]-day_report.xml:=====Excel文件../excel/DATA_QUARLITY/20110721/数据质量日报-20110721_184305.xls开始创建=====
[2011-07-21 18:43:05][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-day_report.xml:-----资源配置报表 生成开始-----
[2011-07-21 18:43:05][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-day_report.xml:资源配置报表 sql: select 
		trunc(sysdate) 日期,
		t0.city_name 地市,
		t0.bsc_count BSC数量,
		t1.cell_count 当前激活小区数量,
		nvl(t2.notactive_cell_count,0) 其他状态小区数量,
		t1.cell_count+nvl(t2.notactive_cell_count,0) 小区总数
		from 
		(
		select 
		grouping_id(city_name) sort_id,
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) bsc_count
		from cm.f_g_c_bsc group by rollup(city_name)
		) t0
		left join
		(
		select 
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) cell_count
		from cm.f_g_c_cell where state='入网在用' group by rollup(city_name)
		) t1
		on t0.city_name=t1.city_name
		left join
		(
		select 
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) notactive_cell_count
		from cm.f_g_c_cell where state<>'入网在用' group by rollup(city_name)
		) t2
		on t0.city_name=t2.city_name
		order by t0.sort_id,t0.city_name
[2011-07-21 18:43:06][com.inspur.db2excel.Main.oneTable2Excel(Main.java:216)][INFO][main]-day_report.xml:资源配置报表 共保存了18条记录
[2011-07-21 18:43:06][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-day_report.xml:-----资源配置报表 生成完成-----
[2011-07-21 18:43:06][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-day_report.xml:-----分地市KPI采集完整率 生成开始-----
[2011-07-21 18:43:06][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-day_report.xml:分地市KPI采集完整率 sql: select 
		trunc(sysdate) 日期,
		t0.city_name 地市,
		t0.bsc_count BSC数量,
		t1.cell_count 当前激活小区数量,
		nvl(t2.notactive_cell_count,0) 其他状态小区数量,
		t1.cell_count+nvl(t2.notactive_cell_count,0) 小区总数,
		t4.hours 计数器采集小时数,
		t1.cell_count*t4.hours 期望采集计数器记录数,
		nvl(t4.record_count,0)+nvl(t5.record_count,0)+nvl(t6.record_count,0) 实际采集计数器记录数,
		round(((nvl(t4.record_count,0)+nvl(t5.record_count,0)+nvl(t6.record_count,0))/t1.cell_count/t4.hours*100),2) 分地市计数器采集完备率,
		t3.hours KPI采集小时数,
		t1.cell_count*t3.hours 期望采集KPI计录数,
		t3.record_count 实际采集KPI记录数,
		round((t3.record_count/t1.cell_count/t3.hours*100),2) 分地市KPI采集完备率
		from 
		(
		select 
		grouping_id(city_name) sort_id,
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) bsc_count
		from cm.f_g_c_bsc group by rollup(city_name)
		) t0
		left join
		(
		select 
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) cell_count
		from cm.f_g_c_cell where state='入网在用' group by rollup(city_name)
		) t1
		on t0.city_name=t1.city_name
		left join
		(
		select 
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) notactive_cell_count
		from cm.f_g_c_cell where state<>'入网在用' group by rollup(city_name)
		) t2
		on t0.city_name=t2.city_name
		left join
		(
		select
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) record_count,
		count(distinct start_time) hours
		from pm.f_g_c_cell_hour 
		where start_time>=trunc(sysdate) and start_time<trunc(sysdate+1) and bsche00 is not null
		group by rollup(city_name)
		) t3
		on t0.city_name=t3.city_name
		left join
		(
		select
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) record_count,
		count(distinct start_time) hours
		from pm.o_g_e_r12_h_celtchf 
		where start_time>=trunc(sysdate) and start_time<trunc(sysdate+1)
		group by rollup(city_name)
		) t4
		on t0.city_name=t4.city_name
		left join
		(
		select
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) record_count,
		count(distinct start_time) hours
		from pm.O_G_H_R11_1275071420_3 
		where start_time>=trunc(sysdate) and start_time<trunc(sysdate+1)
		group by rollup(city_name)
		) t5
		on t0.city_name=t5.city_name
		left join
		(
		select
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) record_count,
		count(distinct start_time) hours
		from pm.o_g_n_s14_h_traffic 
		where start_time>=trunc(sysdate) and start_time<trunc(sysdate+1)
		group by rollup(city_name)
		) t6
		on t0.city_name=t6.city_name
		order by t0.sort_id,t0.city_name
[2011-07-21 18:43:13][com.inspur.db2excel.Main.oneTable2Excel(Main.java:216)][INFO][main]-day_report.xml:分地市KPI采集完整率 共保存了18条记录
[2011-07-21 18:43:13][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-day_report.xml:-----分地市KPI采集完整率 生成完成-----
[2011-07-21 18:43:13][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-day_report.xml:-----分BSC KPI采集完整率 生成开始-----
[2011-07-21 18:43:13][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-day_report.xml:分BSC KPI采集完整率 sql: select 
		trunc(sysdate) 日期,
		t1.city_name 地市,
		t1.bsc_uk BSC名称,
		t1.vendor_name 厂商名称,
		t1.cell_count 当前激活小区数量,
		nvl(t2.notactive_cell_count,0) 其他状态小区数量,
		t1.cell_count+nvl(t2.notactive_cell_count,0) 小区总数,
		t4.hours 计数器采集小时数,
		t1.cell_count*t4.hours 期望采集计数器记录数,
		nvl(t4.record_count,0)+nvl(t5.record_count,0)+nvl(t6.record_count,0) 实际采集计数器记录数,
		round(((nvl(t4.record_count,0)+nvl(t5.record_count,0)+nvl(t6.record_count,0))/t1.cell_count/t4.hours*100),2) 分BSC计数器采集完备率,
		t3.hours KPI采集小时数,
		t1.cell_count*t3.hours 期望采集KPI计录数,
		t3.record_count 实际采集KPI记录数,
		round((t3.record_count/t1.cell_count/t3.hours*100),2) 分BSCKPI采集完备率
		from 
		(
		select 
		city_name,bsc_uk,vendor_name,count(*) cell_count
		from cm.f_g_c_cell where state='入网在用' group by city_name,bsc_uk,vendor_name
		) t1
		left join
		(
		select 
		city_name,bsc_uk,vendor_name,count(*) notactive_cell_count
		from cm.f_g_c_cell where state<>'入网在用' group by city_name,bsc_uk,vendor_name
		) t2
		on t1.vendor_name=t2.vendor_name and t1.bsc_uk=t2.bsc_uk and t1.city_name=t2.city_name
		left join
		(
		select
		city_name,bsc_uk,vendor_name,
		count(*) record_count,
		count(distinct start_time) hours
		from pm.f_g_c_cell_hour 
		where start_time>=trunc(sysdate) and start_time<trunc(sysdate+1) and bsche00 is not null
		group by city_name,bsc_uk,vendor_name
		) t3
		on t1.vendor_name=t3.vendor_name and t1.bsc_uk=t3.bsc_uk and t1.city_name=t3.city_name
		left join
		(
		select
		city_name,bsc_uk,'爱立信' vendor_name,
		count(*) record_count,
		count(distinct start_time) hours
		from pm.o_g_e_r12_h_celtchf 
		where start_time>=trunc(sysdate) and start_time<trunc(sysdate+1)
		group by city_name,bsc_uk
		) t4
		on t1.vendor_name=t4.vendor_name and t1.bsc_uk=t4.bsc_uk and t1.city_name=t4.city_name
		left join
		(
		select
		city_name,bsc_uk,'华为' vendor_name,
		count(*) record_count,
		count(distinct start_time) hours
		from pm.O_G_H_R11_1275071420_3 
		where start_time>=trunc(sysdate) and start_time<trunc(sysdate+1)
		group by city_name,bsc_uk
		) t5
		on t1.vendor_name=t5.vendor_name and t1.bsc_uk=t5.bsc_uk and t1.city_name=t5.city_name
		left join
		(
		select
		city_name,bsc_uk,'诺基亚' vendor_name,
		count(*) record_count,
		count(distinct start_time) hours
		from pm.o_g_n_s14_h_traffic 
		where start_time>=trunc(sysdate) and start_time<trunc(sysdate+1)
		group by city_name,bsc_uk
		) t6
		on t1.vendor_name=t6.vendor_name and t1.bsc_uk=t6.bsc_uk and t1.city_name=t6.city_name
		order by t1.vendor_name,t1.bsc_uk
[2011-07-21 18:43:19][com.inspur.db2excel.Main.oneTable2Excel(Main.java:213)][INFO][main]-day_report.xml:分BSC KPI采集完整率 保存了101条记录
[2011-07-21 18:43:19][com.inspur.db2excel.Main.oneTable2Excel(Main.java:213)][INFO][main]-day_report.xml:分BSC KPI采集完整率 保存了201条记录
[2011-07-21 18:43:19][com.inspur.db2excel.Main.oneTable2Excel(Main.java:213)][INFO][main]-day_report.xml:分BSC KPI采集完整率 保存了301条记录
[2011-07-21 18:43:19][com.inspur.db2excel.Main.oneTable2Excel(Main.java:213)][INFO][main]-day_report.xml:分BSC KPI采集完整率 保存了401条记录
[2011-07-21 18:43:20][com.inspur.db2excel.Main.oneTable2Excel(Main.java:213)][INFO][main]-day_report.xml:分BSC KPI采集完整率 保存了501条记录
[2011-07-21 18:43:20][com.inspur.db2excel.Main.oneTable2Excel(Main.java:216)][INFO][main]-day_report.xml:分BSC KPI采集完整率 共保存了591条记录
[2011-07-21 18:43:20][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-day_report.xml:-----分BSC KPI采集完整率 生成完成-----
[2011-07-21 18:43:20][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-day_report.xml:-----分地市MRR采集情况 生成开始-----
[2011-07-21 18:43:20][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-day_report.xml:分地市MRR采集情况 sql: select 
		trunc(sysdate) 日期,
		t0.city_name 地市,
		t0.bsc_count BSC数量,
		t1.cell_count 当前激活小区数量,
		nvl(t2.notactive_cell_count,0) 其他状态小区数量,
		t1.cell_count+nvl(t2.notactive_cell_count,0) 小区总数,
		t3.hours MR采集小时数,
		t1.cell_count*t3.hours 期望采集MR计录数,
		t3.record_count 实际采集MR记录数,
		round((t3.record_count/t1.cell_count/t3.hours*100),2) 分地市KPI采集完备率
		from 
		(
		select
		grouping_id(city_name) sort_id,
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) bsc_count
		from cm.f_g_c_bsc 
		group by rollup(city_name)
		) t0
		left join
		(
		select 
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) cell_count
		from cm.f_g_c_cell where state='入网在用' group by rollup(city_name)
		) t1
		on t0.city_name=t1.city_name
		left join
		(
		select 
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) notactive_cell_count
		from cm.f_g_c_cell where state<>'入网在用' group by rollup(city_name)
		) t2
		on t0.city_name=t2.city_name
		left join
		(
		select
		decode(grouping_id(regionname),0,regionname,'全省') regionname,
		count(*) record_count,
		count(distinct starttime) hours
		from sdpm.cell_mr_h 
		where starttime>=trunc(sysdate) and starttime<trunc(sysdate+1) 
		group by rollup(regionname)
		) t3
		on t0.city_name=t3.regionname
		order by t0.sort_id,t0.city_name
[2011-07-21 18:43:21][com.inspur.db2excel.Main.oneTable2Excel(Main.java:216)][INFO][main]-day_report.xml:分地市MRR采集情况 共保存了18条记录
[2011-07-21 18:43:21][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-day_report.xml:-----分地市MRR采集情况 生成完成-----
[2011-07-21 18:43:21][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-day_report.xml:-----分BSC的MRR采集完备情况 生成开始-----
[2011-07-21 18:43:21][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-day_report.xml:分BSC的MRR采集完备情况 sql: select 
		trunc(sysdate) 日期,
		t1.city_name 地市,
		t1.bsc_uk BSC名称,
		t1.cell_count 当前激活小区数量,
		nvl(t2.notactive_cell_count,0) 其他状态小区数量,
		t1.cell_count+nvl(t2.notactive_cell_count,0) 小区总数,
		t3.hours MR采集小时数,
		t1.cell_count*t3.hours 期望采集MR计录数,
		t3.record_count 实际采集MR记录数,
		round((t3.record_count/t1.cell_count/t3.hours*100),2) 分地市KPI采集完备率
		from 
		(
		select 
		city_name,bsc_uk,
		count(*) cell_count
		from cm.f_g_c_cell where state='入网在用' group by city_name,bsc_uk
		) t1
		left join
		(
		select 
		city_name,bsc_uk,
		count(*) notactive_cell_count
		from cm.f_g_c_cell where state<>'入网在用' group by city_name,bsc_uk
		) t2
		on t1.bsc_uk=t2.bsc_uk and t1.city_name=t2.city_name
		left join
		(
		select
		regionname,
		bscid,
		count(*) record_count,
		count(distinct starttime) hours
		from sdpm.cell_mr_h 
		where starttime>=trunc(sysdate) and starttime<trunc(sysdate+1) 
		group by regionname,bscid
		) t3
		on t1.bsc_uk=t3.bscid and t1.city_name=t3.regionname
		order by t1.city_name
[2011-07-21 18:43:22][com.inspur.db2excel.Main.oneTable2Excel(Main.java:213)][INFO][main]-day_report.xml:分BSC的MRR采集完备情况 保存了101条记录
[2011-07-21 18:43:22][com.inspur.db2excel.Main.oneTable2Excel(Main.java:213)][INFO][main]-day_report.xml:分BSC的MRR采集完备情况 保存了201条记录
[2011-07-21 18:43:22][com.inspur.db2excel.Main.oneTable2Excel(Main.java:213)][INFO][main]-day_report.xml:分BSC的MRR采集完备情况 保存了301条记录
[2011-07-21 18:43:22][com.inspur.db2excel.Main.oneTable2Excel(Main.java:213)][INFO][main]-day_report.xml:分BSC的MRR采集完备情况 保存了401条记录
[2011-07-21 18:43:22][com.inspur.db2excel.Main.oneTable2Excel(Main.java:213)][INFO][main]-day_report.xml:分BSC的MRR采集完备情况 保存了501条记录
[2011-07-21 18:43:22][com.inspur.db2excel.Main.oneTable2Excel(Main.java:216)][INFO][main]-day_report.xml:分BSC的MRR采集完备情况 共保存了591条记录
[2011-07-21 18:43:22][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-day_report.xml:-----分BSC的MRR采集完备情况 生成完成-----
[2011-07-21 18:43:23][com.inspur.db2excel.Main.db2excel(Main.java:117)][INFO][main]-day_report.xml:=====Excel文件../excel/DATA_QUARLITY/20110721/数据质量日报-20110721_184305.xls保存完成=====
[2011-07-21 18:45:41][com.inspur.db2excel.Main.db2excel(Main.java:94)][INFO][main]-day_report.xml:=====Excel文件../excel/DATA_QUARLITY/20110721/数据质量日报-20110721_184541.xls开始创建=====
[2011-07-21 18:45:42][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-day_report.xml:-----资源配置报表 生成开始-----
[2011-07-21 18:45:42][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-day_report.xml:资源配置报表 sql: select 
		trunc(sysdate) 日期,
		t0.city_name 地市,
		t0.bsc_count BSC数量,
		t1.cell_count 当前激活小区数量,
		nvl(t2.notactive_cell_count,0) 其他状态小区数量,
		t1.cell_count+nvl(t2.notactive_cell_count,0) 小区总数
		from 
		(
		select 
		grouping_id(city_name) sort_id,
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) bsc_count
		from cm.f_g_c_bsc group by rollup(city_name)
		) t0
		left join
		(
		select 
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) cell_count
		from cm.f_g_c_cell where state='入网在用' group by rollup(city_name)
		) t1
		on t0.city_name=t1.city_name
		left join
		(
		select 
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) notactive_cell_count
		from cm.f_g_c_cell where state<>'入网在用' group by rollup(city_name)
		) t2
		on t0.city_name=t2.city_name
		order by t0.sort_id,t0.city_name
[2011-07-21 18:45:42][com.inspur.db2excel.Main.oneTable2Excel(Main.java:216)][INFO][main]-day_report.xml:资源配置报表 共保存了18条记录
[2011-07-21 18:45:42][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-day_report.xml:-----资源配置报表 生成完成-----
[2011-07-21 18:45:42][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-day_report.xml:-----分地市KPI采集完整率 生成开始-----
[2011-07-21 18:45:42][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-day_report.xml:分地市KPI采集完整率 sql: select 
		trunc(sysdate) 日期,
		t0.city_name 地市,
		t0.bsc_count BSC数量,
		t1.cell_count 当前激活小区数量,
		nvl(t2.notactive_cell_count,0) 其他状态小区数量,
		t1.cell_count+nvl(t2.notactive_cell_count,0) 小区总数,
		t4.hours 计数器采集小时数,
		t1.cell_count*t4.hours 期望采集计数器记录数,
		nvl(t4.record_count,0)+nvl(t5.record_count,0)+nvl(t6.record_count,0) 实际采集计数器记录数,
		round(((nvl(t4.record_count,0)+nvl(t5.record_count,0)+nvl(t6.record_count,0))/t1.cell_count/t4.hours*100),2)||'%' 分地市计数器采集完备率,
		t3.hours KPI采集小时数,
		t1.cell_count*t3.hours 期望采集KPI计录数,
		t3.record_count 实际采集KPI记录数,
		round((t3.record_count/t1.cell_count/t3.hours*100),2)||'%' 分地市KPI采集完备率
		from 
		(
		select 
		grouping_id(city_name) sort_id,
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) bsc_count
		from cm.f_g_c_bsc group by rollup(city_name)
		) t0
		left join
		(
		select 
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) cell_count
		from cm.f_g_c_cell where state='入网在用' group by rollup(city_name)
		) t1
		on t0.city_name=t1.city_name
		left join
		(
		select 
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) notactive_cell_count
		from cm.f_g_c_cell where state<>'入网在用' group by rollup(city_name)
		) t2
		on t0.city_name=t2.city_name
		left join
		(
		select
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) record_count,
		count(distinct start_time) hours
		from pm.f_g_c_cell_hour 
		where start_time>=trunc(sysdate) and start_time<trunc(sysdate+1) and bsche00 is not null
		group by rollup(city_name)
		) t3
		on t0.city_name=t3.city_name
		left join
		(
		select
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) record_count,
		count(distinct start_time) hours
		from pm.o_g_e_r12_h_celtchf 
		where start_time>=trunc(sysdate) and start_time<trunc(sysdate+1)
		group by rollup(city_name)
		) t4
		on t0.city_name=t4.city_name
		left join
		(
		select
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) record_count,
		count(distinct start_time) hours
		from pm.O_G_H_R11_1275071420_3 
		where start_time>=trunc(sysdate) and start_time<trunc(sysdate+1)
		group by rollup(city_name)
		) t5
		on t0.city_name=t5.city_name
		left join
		(
		select
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) record_count,
		count(distinct start_time) hours
		from pm.o_g_n_s14_h_traffic 
		where start_time>=trunc(sysdate) and start_time<trunc(sysdate+1)
		group by rollup(city_name)
		) t6
		on t0.city_name=t6.city_name
		order by t0.sort_id,t0.city_name
[2011-07-21 18:45:50][com.inspur.db2excel.Main.oneTable2Excel(Main.java:216)][INFO][main]-day_report.xml:分地市KPI采集完整率 共保存了18条记录
[2011-07-21 18:45:50][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-day_report.xml:-----分地市KPI采集完整率 生成完成-----
[2011-07-21 18:45:50][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-day_report.xml:-----分BSC KPI采集完整率 生成开始-----
[2011-07-21 18:45:50][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-day_report.xml:分BSC KPI采集完整率 sql: select 
		trunc(sysdate) 日期,
		t1.city_name 地市,
		t1.bsc_uk BSC名称,
		t1.vendor_name 厂商名称,
		t1.cell_count 当前激活小区数量,
		nvl(t2.notactive_cell_count,0) 其他状态小区数量,
		t1.cell_count+nvl(t2.notactive_cell_count,0) 小区总数,
		t4.hours 计数器采集小时数,
		t1.cell_count*t4.hours 期望采集计数器记录数,
		nvl(t4.record_count,0)+nvl(t5.record_count,0)+nvl(t6.record_count,0) 实际采集计数器记录数,
		round(((nvl(t4.record_count,0)+nvl(t5.record_count,0)+nvl(t6.record_count,0))/t1.cell_count/t4.hours*100),2)||'%' 分BSC计数器采集完备率,
		t3.hours KPI采集小时数,
		t1.cell_count*t3.hours 期望采集KPI计录数,
		t3.record_count 实际采集KPI记录数,
		round((t3.record_count/t1.cell_count/t3.hours*100),2)||'%' 分BSCKPI采集完备率
		from 
		(
		select 
		city_name,bsc_uk,vendor_name,count(*) cell_count
		from cm.f_g_c_cell where state='入网在用' group by city_name,bsc_uk,vendor_name
		) t1
		left join
		(
		select 
		city_name,bsc_uk,vendor_name,count(*) notactive_cell_count
		from cm.f_g_c_cell where state<>'入网在用' group by city_name,bsc_uk,vendor_name
		) t2
		on t1.vendor_name=t2.vendor_name and t1.bsc_uk=t2.bsc_uk and t1.city_name=t2.city_name
		left join
		(
		select
		city_name,bsc_uk,vendor_name,
		count(*) record_count,
		count(distinct start_time) hours
		from pm.f_g_c_cell_hour 
		where start_time>=trunc(sysdate) and start_time<trunc(sysdate+1) and bsche00 is not null
		group by city_name,bsc_uk,vendor_name
		) t3
		on t1.vendor_name=t3.vendor_name and t1.bsc_uk=t3.bsc_uk and t1.city_name=t3.city_name
		left join
		(
		select
		city_name,bsc_uk,'爱立信' vendor_name,
		count(*) record_count,
		count(distinct start_time) hours
		from pm.o_g_e_r12_h_celtchf 
		where start_time>=trunc(sysdate) and start_time<trunc(sysdate+1)
		group by city_name,bsc_uk
		) t4
		on t1.vendor_name=t4.vendor_name and t1.bsc_uk=t4.bsc_uk and t1.city_name=t4.city_name
		left join
		(
		select
		city_name,bsc_uk,'华为' vendor_name,
		count(*) record_count,
		count(distinct start_time) hours
		from pm.O_G_H_R11_1275071420_3 
		where start_time>=trunc(sysdate) and start_time<trunc(sysdate+1)
		group by city_name,bsc_uk
		) t5
		on t1.vendor_name=t5.vendor_name and t1.bsc_uk=t5.bsc_uk and t1.city_name=t5.city_name
		left join
		(
		select
		city_name,bsc_uk,'诺基亚' vendor_name,
		count(*) record_count,
		count(distinct start_time) hours
		from pm.o_g_n_s14_h_traffic 
		where start_time>=trunc(sysdate) and start_time<trunc(sysdate+1)
		group by city_name,bsc_uk
		) t6
		on t1.vendor_name=t6.vendor_name and t1.bsc_uk=t6.bsc_uk and t1.city_name=t6.city_name
		order by t1.vendor_name,t1.bsc_uk
[2011-07-21 18:45:56][com.inspur.db2excel.Main.oneTable2Excel(Main.java:213)][INFO][main]-day_report.xml:分BSC KPI采集完整率 保存了101条记录
[2011-07-21 18:45:56][com.inspur.db2excel.Main.oneTable2Excel(Main.java:213)][INFO][main]-day_report.xml:分BSC KPI采集完整率 保存了201条记录
[2011-07-21 18:45:56][com.inspur.db2excel.Main.oneTable2Excel(Main.java:213)][INFO][main]-day_report.xml:分BSC KPI采集完整率 保存了301条记录
[2011-07-21 18:45:56][com.inspur.db2excel.Main.oneTable2Excel(Main.java:213)][INFO][main]-day_report.xml:分BSC KPI采集完整率 保存了401条记录
[2011-07-21 18:52:31][com.inspur.db2excel.Main.db2excel(Main.java:94)][INFO][main]-day_report.xml:=====Excel文件../excel/DATA_QUARLITY/20110721/数据质量日报-20110721_185231.xls开始创建=====
[2011-07-21 18:52:31][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-day_report.xml:-----资源配置报表 生成开始-----
[2011-07-21 18:52:31][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-day_report.xml:资源配置报表 sql: select 
		trunc(sysdate-1) 日期,
		t0.city_name 地市,
		t0.bsc_count BSC数量,
		t1.cell_count 当前激活小区数量,
		nvl(t2.notactive_cell_count,0) 其他状态小区数量,
		t1.cell_count+nvl(t2.notactive_cell_count,0) 小区总数
		from 
		(
		select 
		grouping_id(city_name) sort_id,
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) bsc_count
		from cm.f_g_c_bsc group by rollup(city_name)
		) t0
		left join
		(
		select 
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) cell_count
		from cm.f_g_c_cell where state='入网在用' group by rollup(city_name)
		) t1
		on t0.city_name=t1.city_name
		left join
		(
		select 
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) notactive_cell_count
		from cm.f_g_c_cell where state<>'入网在用' group by rollup(city_name)
		) t2
		on t0.city_name=t2.city_name
		order by t0.sort_id,t0.city_name
[2011-07-21 18:52:32][com.inspur.db2excel.Main.oneTable2Excel(Main.java:216)][INFO][main]-day_report.xml:资源配置报表 共保存了18条记录
[2011-07-21 18:52:32][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-day_report.xml:-----资源配置报表 生成完成-----
[2011-07-21 18:52:32][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-day_report.xml:-----分地市KPI采集完整率 生成开始-----
[2011-07-21 18:52:32][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-day_report.xml:分地市KPI采集完整率 sql: select 
		trunc(sysdate-1) 日期,
		t0.city_name 地市,
		t0.bsc_count BSC数量,
		t1.cell_count 当前激活小区数量,
		nvl(t2.notactive_cell_count,0) 其他状态小区数量,
		t1.cell_count+nvl(t2.notactive_cell_count,0) 小区总数,
		t4.hours 计数器采集小时数,
		t1.cell_count*t4.hours 期望采集计数器记录数,
		nvl(t4.record_count,0)+nvl(t5.record_count,0)+nvl(t6.record_count,0) 实际采集计数器记录数,
		round(((nvl(t4.record_count,0)+nvl(t5.record_count,0)+nvl(t6.record_count,0))/t1.cell_count/t4.hours*100),2)||'%' 分地市计数器采集完备率,
		t3.hours KPI采集小时数,
		t1.cell_count*t3.hours 期望采集KPI计录数,
		t3.record_count 实际采集KPI记录数,
		round((t3.record_count/t1.cell_count/t3.hours*100),2)||'%' 分地市KPI采集完备率
		from 
		(
		select 
		grouping_id(city_name) sort_id,
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) bsc_count
		from cm.f_g_c_bsc group by rollup(city_name)
		) t0
		left join
		(
		select 
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) cell_count
		from cm.f_g_c_cell where state='入网在用' group by rollup(city_name)
		) t1
		on t0.city_name=t1.city_name
		left join
		(
		select 
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) notactive_cell_count
		from cm.f_g_c_cell where state<>'入网在用' group by rollup(city_name)
		) t2
		on t0.city_name=t2.city_name
		left join
		(
		select
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) record_count,
		count(distinct start_time) hours
		from pm.f_g_c_cell_hour 
		where start_time>=trunc(sysdate-1) and start_time<trunc(sysdate) and bsche00 is not null
		group by rollup(city_name)
		) t3
		on t0.city_name=t3.city_name
		left join
		(
		select
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) record_count,
		count(distinct start_time) hours
		from pm.o_g_e_r12_h_celtchf 
		where start_time>=trunc(sysdate-1) and start_time<trunc(sysdate)
		group by rollup(city_name)
		) t4
		on t0.city_name=t4.city_name
		left join
		(
		select
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) record_count,
		count(distinct start_time) hours
		from pm.O_G_H_R11_1275071420_3 
		where start_time>=trunc(sysdate-1) and start_time<trunc(sysdate)
		group by rollup(city_name)
		) t5
		on t0.city_name=t5.city_name
		left join
		(
		select
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) record_count,
		count(distinct start_time) hours
		from pm.o_g_n_s14_h_traffic 
		where start_time>=trunc(sysdate-1) and start_time<trunc(sysdate)
		group by rollup(city_name)
		) t6
		on t0.city_name=t6.city_name
		order by t0.sort_id,t0.city_name
[2011-07-21 18:53:00][com.inspur.db2excel.Main.db2excel(Main.java:94)][INFO][main]-day_report.xml:=====Excel文件../excel/DATA_QUARLITY/20110721/数据质量日报-20110721_185300.xls开始创建=====
[2011-07-21 18:53:00][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-day_report.xml:-----资源配置报表 生成开始-----
[2011-07-21 18:53:00][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-day_report.xml:资源配置报表 sql: select 
		trunc(sysdate-1) 日期,
		t0.city_name 地市,
		t0.bsc_count BSC数量,
		t1.cell_count 当前激活小区数量,
		nvl(t2.notactive_cell_count,0) 其他状态小区数量,
		t1.cell_count+nvl(t2.notactive_cell_count,0) 小区总数
		from 
		(
		select 
		grouping_id(city_name) sort_id,
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) bsc_count
		from cm.f_g_c_bsc group by rollup(city_name)
		) t0
		left join
		(
		select 
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) cell_count
		from cm.f_g_c_cell where state='入网在用' group by rollup(city_name)
		) t1
		on t0.city_name=t1.city_name
		left join
		(
		select 
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) notactive_cell_count
		from cm.f_g_c_cell where state<>'入网在用' group by rollup(city_name)
		) t2
		on t0.city_name=t2.city_name
		order by t0.sort_id,t0.city_name
[2011-07-21 18:53:01][com.inspur.db2excel.Main.oneTable2Excel(Main.java:216)][INFO][main]-day_report.xml:资源配置报表 共保存了18条记录
[2011-07-21 18:53:01][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-day_report.xml:-----资源配置报表 生成完成-----
[2011-07-21 18:53:01][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-day_report.xml:-----分地市KPI采集完整率 生成开始-----
[2011-07-21 18:53:01][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-day_report.xml:分地市KPI采集完整率 sql: select 
		trunc(sysdate-1) 日期,
		t0.city_name 地市,
		t0.bsc_count BSC数量,
		t1.cell_count 当前激活小区数量,
		nvl(t2.notactive_cell_count,0) 其他状态小区数量,
		t1.cell_count+nvl(t2.notactive_cell_count,0) 小区总数,
		t4.hours 计数器采集小时数,
		t1.cell_count*t4.hours 期望采集计数器记录数,
		nvl(t4.record_count,0)+nvl(t5.record_count,0)+nvl(t6.record_count,0) 实际采集计数器记录数,
		round(((nvl(t4.record_count,0)+nvl(t5.record_count,0)+nvl(t6.record_count,0))/t1.cell_count/t4.hours*100),2) 分地市计数器采集完备率,
		t3.hours KPI采集小时数,
		t1.cell_count*t3.hours 期望采集KPI计录数,
		t3.record_count 实际采集KPI记录数,
		round((t3.record_count/t1.cell_count/t3.hours*100),2) 分地市KPI采集完备率
		from 
		(
		select 
		grouping_id(city_name) sort_id,
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) bsc_count
		from cm.f_g_c_bsc group by rollup(city_name)
		) t0
		left join
		(
		select 
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) cell_count
		from cm.f_g_c_cell where state='入网在用' group by rollup(city_name)
		) t1
		on t0.city_name=t1.city_name
		left join
		(
		select 
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) notactive_cell_count
		from cm.f_g_c_cell where state<>'入网在用' group by rollup(city_name)
		) t2
		on t0.city_name=t2.city_name
		left join
		(
		select
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) record_count,
		count(distinct start_time) hours
		from pm.f_g_c_cell_hour 
		where start_time>=trunc(sysdate-1) and start_time<trunc(sysdate) and bsche00 is not null
		group by rollup(city_name)
		) t3
		on t0.city_name=t3.city_name
		left join
		(
		select
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) record_count,
		count(distinct start_time) hours
		from pm.o_g_e_r12_h_celtchf 
		where start_time>=trunc(sysdate-1) and start_time<trunc(sysdate)
		group by rollup(city_name)
		) t4
		on t0.city_name=t4.city_name
		left join
		(
		select
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) record_count,
		count(distinct start_time) hours
		from pm.O_G_H_R11_1275071420_3 
		where start_time>=trunc(sysdate-1) and start_time<trunc(sysdate)
		group by rollup(city_name)
		) t5
		on t0.city_name=t5.city_name
		left join
		(
		select
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) record_count,
		count(distinct start_time) hours
		from pm.o_g_n_s14_h_traffic 
		where start_time>=trunc(sysdate-1) and start_time<trunc(sysdate)
		group by rollup(city_name)
		) t6
		on t0.city_name=t6.city_name
		order by t0.sort_id,t0.city_name
[2011-07-21 18:53:02][com.inspur.db2excel.Main.oneTable2Excel(Main.java:216)][INFO][main]-day_report.xml:分地市KPI采集完整率 共保存了18条记录
[2011-07-21 18:53:02][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-day_report.xml:-----分地市KPI采集完整率 生成完成-----
[2011-07-21 18:53:02][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-day_report.xml:-----分BSC KPI采集完整率 生成开始-----
[2011-07-21 18:53:02][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-day_report.xml:分BSC KPI采集完整率 sql: select 
		trunc(sysdate) 日期,
		t1.city_name 地市,
		t1.bsc_uk BSC名称,
		t1.vendor_name 厂商名称,
		t1.cell_count 当前激活小区数量,
		nvl(t2.notactive_cell_count,0) 其他状态小区数量,
		t1.cell_count+nvl(t2.notactive_cell_count,0) 小区总数,
		t4.hours 计数器采集小时数,
		t1.cell_count*t4.hours 期望采集计数器记录数,
		nvl(t4.record_count,0)+nvl(t5.record_count,0)+nvl(t6.record_count,0) 实际采集计数器记录数,
		round(((nvl(t4.record_count,0)+nvl(t5.record_count,0)+nvl(t6.record_count,0))/t1.cell_count/t4.hours*100),2) 分BSC计数器采集完备率,
		t3.hours KPI采集小时数,
		t1.cell_count*t3.hours 期望采集KPI计录数,
		t3.record_count 实际采集KPI记录数,
		round((t3.record_count/t1.cell_count/t3.hours*100),2) 分BSCKPI采集完备率
		from 
		(
		select 
		city_name,bsc_uk,vendor_name,count(*) cell_count
		from cm.f_g_c_cell where state='入网在用' group by city_name,bsc_uk,vendor_name
		) t1
		left join
		(
		select 
		city_name,bsc_uk,vendor_name,count(*) notactive_cell_count
		from cm.f_g_c_cell where state<>'入网在用' group by city_name,bsc_uk,vendor_name
		) t2
		on t1.vendor_name=t2.vendor_name and t1.bsc_uk=t2.bsc_uk and t1.city_name=t2.city_name
		left join
		(
		select
		city_name,bsc_uk,vendor_name,
		count(*) record_count,
		count(distinct start_time) hours
		from pm.f_g_c_cell_hour 
		where start_time>=trunc(sysdate-1) and start_time<trunc(sysdate) and bsche00 is not null
		group by city_name,bsc_uk,vendor_name
		) t3
		on t1.vendor_name=t3.vendor_name and t1.bsc_uk=t3.bsc_uk and t1.city_name=t3.city_name
		left join
		(
		select
		city_name,bsc_uk,'爱立信' vendor_name,
		count(*) record_count,
		count(distinct start_time) hours
		from pm.o_g_e_r12_h_celtchf 
		where start_time>=trunc(sysdate-1) and start_time<trunc(sysdate)
		group by city_name,bsc_uk
		) t4
		on t1.vendor_name=t4.vendor_name and t1.bsc_uk=t4.bsc_uk and t1.city_name=t4.city_name
		left join
		(
		select
		city_name,bsc_uk,'华为' vendor_name,
		count(*) record_count,
		count(distinct start_time) hours
		from pm.O_G_H_R11_1275071420_3 
		where start_time>=trunc(sysdate-1) and start_time<trunc(sysdate)
		group by city_name,bsc_uk
		) t5
		on t1.vendor_name=t5.vendor_name and t1.bsc_uk=t5.bsc_uk and t1.city_name=t5.city_name
		left join
		(
		select
		city_name,bsc_uk,'诺基亚' vendor_name,
		count(*) record_count,
		count(distinct start_time) hours
		from pm.o_g_n_s14_h_traffic 
		where start_time>=trunc(sysdate-1) and start_time<trunc(sysdate)
		group by city_name,bsc_uk
		) t6
		on t1.vendor_name=t6.vendor_name and t1.bsc_uk=t6.bsc_uk and t1.city_name=t6.city_name
		order by t1.vendor_name,t1.bsc_uk
[2011-07-21 18:53:03][com.inspur.db2excel.Main.oneTable2Excel(Main.java:213)][INFO][main]-day_report.xml:分BSC KPI采集完整率 保存了101条记录
[2011-07-21 18:53:03][com.inspur.db2excel.Main.oneTable2Excel(Main.java:213)][INFO][main]-day_report.xml:分BSC KPI采集完整率 保存了201条记录
[2011-07-21 18:53:03][com.inspur.db2excel.Main.oneTable2Excel(Main.java:213)][INFO][main]-day_report.xml:分BSC KPI采集完整率 保存了301条记录
[2011-07-21 18:53:03][com.inspur.db2excel.Main.oneTable2Excel(Main.java:213)][INFO][main]-day_report.xml:分BSC KPI采集完整率 保存了401条记录
[2011-07-21 18:53:03][com.inspur.db2excel.Main.oneTable2Excel(Main.java:213)][INFO][main]-day_report.xml:分BSC KPI采集完整率 保存了501条记录
[2011-07-21 18:53:04][com.inspur.db2excel.Main.oneTable2Excel(Main.java:216)][INFO][main]-day_report.xml:分BSC KPI采集完整率 共保存了591条记录
[2011-07-21 18:53:04][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-day_report.xml:-----分BSC KPI采集完整率 生成完成-----
[2011-07-21 18:53:04][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-day_report.xml:-----分地市MRR采集情况 生成开始-----
[2011-07-21 18:53:04][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-day_report.xml:分地市MRR采集情况 sql: select 
		trunc(sysdate) 日期,
		t0.city_name 地市,
		t0.bsc_count BSC数量,
		t1.cell_count 当前激活小区数量,
		nvl(t2.notactive_cell_count,0) 其他状态小区数量,
		t1.cell_count+nvl(t2.notactive_cell_count,0) 小区总数,
		t3.hours MR采集小时数,
		t1.cell_count*t3.hours 期望采集MR计录数,
		t3.record_count 实际采集MR记录数,
		nvl(round((t3.record_count/t1.cell_count/t3.hours*100),2),0) 分地市MR采集完备率
		from 
		(
		select
		grouping_id(city_name) sort_id,
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) bsc_count
		from cm.f_g_c_bsc 
		group by rollup(city_name)
		) t0
		left join
		(
		select 
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) cell_count
		from cm.f_g_c_cell where state='入网在用' group by rollup(city_name)
		) t1
		on t0.city_name=t1.city_name
		left join
		(
		select 
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) notactive_cell_count
		from cm.f_g_c_cell where state<>'入网在用' group by rollup(city_name)
		) t2
		on t0.city_name=t2.city_name
		left join
		(
		select
		decode(grouping_id(regionname),0,regionname,'全省') regionname,
		count(*) record_count,
		count(distinct starttime) hours
		from sdpm.cell_mr_h 
		where starttime>=trunc(sysdate-1) and starttime<trunc(sysdate) 
		group by rollup(regionname)
		) t3
		on t0.city_name=t3.regionname
		order by t0.sort_id,t0.city_name
[2011-07-21 18:53:06][com.inspur.db2excel.Main.oneTable2Excel(Main.java:216)][INFO][main]-day_report.xml:分地市MRR采集情况 共保存了18条记录
[2011-07-21 18:53:06][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-day_report.xml:-----分地市MRR采集情况 生成完成-----
[2011-07-21 18:53:06][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-day_report.xml:-----分BSC的MRR采集完备情况 生成开始-----
[2011-07-21 18:53:06][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-day_report.xml:分BSC的MRR采集完备情况 sql: select 
		trunc(sysdate) 日期,
		t1.city_name 地市,
		t1.bsc_uk BSC名称,
		t1.cell_count 当前激活小区数量,
		nvl(t2.notactive_cell_count,0) 其他状态小区数量,
		t1.cell_count+nvl(t2.notactive_cell_count,0) 小区总数,
		t3.hours MR采集小时数,
		t1.cell_count*t3.hours 期望采集MR计录数,
		t3.record_count 实际采集MR记录数,
		nvl(round((t3.record_count/t1.cell_count/t3.hours*100),2),0) 分BSC MR采集完备率
		from 
		(
		select 
		city_name,bsc_uk,
		count(*) cell_count
		from cm.f_g_c_cell where state='入网在用' group by city_name,bsc_uk
		) t1
		left join
		(
		select 
		city_name,bsc_uk,
		count(*) notactive_cell_count
		from cm.f_g_c_cell where state<>'入网在用' group by city_name,bsc_uk
		) t2
		on t1.bsc_uk=t2.bsc_uk and t1.city_name=t2.city_name
		left join
		(
		select
		regionname,
		bscid,
		count(*) record_count,
		count(distinct starttime) hours
		from sdpm.cell_mr_h 
		where starttime>=trunc(sysdate-1) and starttime<trunc(sysdate) 
		group by regionname,bscid
		) t3
		on t1.bsc_uk=t3.bscid and t1.city_name=t3.regionname
		order by t1.city_name
[2011-07-21 18:53:45][com.inspur.db2excel.Main.db2excel(Main.java:94)][INFO][main]-day_report.xml:=====Excel文件../excel/DATA_QUARLITY/20110721/数据质量日报-20110721_185345.xls开始创建=====
[2011-07-21 18:53:46][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-day_report.xml:-----资源配置报表 生成开始-----
[2011-07-21 18:53:46][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-day_report.xml:资源配置报表 sql: select 
		trunc(sysdate-1) 日期,
		t0.city_name 地市,
		t0.bsc_count BSC数量,
		t1.cell_count 当前激活小区数量,
		nvl(t2.notactive_cell_count,0) 其他状态小区数量,
		t1.cell_count+nvl(t2.notactive_cell_count,0) 小区总数
		from 
		(
		select 
		grouping_id(city_name) sort_id,
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) bsc_count
		from cm.f_g_c_bsc group by rollup(city_name)
		) t0
		left join
		(
		select 
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) cell_count
		from cm.f_g_c_cell where state='入网在用' group by rollup(city_name)
		) t1
		on t0.city_name=t1.city_name
		left join
		(
		select 
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) notactive_cell_count
		from cm.f_g_c_cell where state<>'入网在用' group by rollup(city_name)
		) t2
		on t0.city_name=t2.city_name
		order by t0.sort_id,t0.city_name
[2011-07-21 18:53:46][com.inspur.db2excel.Main.oneTable2Excel(Main.java:216)][INFO][main]-day_report.xml:资源配置报表 共保存了18条记录
[2011-07-21 18:53:46][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-day_report.xml:-----资源配置报表 生成完成-----
[2011-07-21 18:53:46][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-day_report.xml:-----分地市KPI采集完整率 生成开始-----
[2011-07-21 18:53:46][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-day_report.xml:分地市KPI采集完整率 sql: select 
		trunc(sysdate-1) 日期,
		t0.city_name 地市,
		t0.bsc_count BSC数量,
		t1.cell_count 当前激活小区数量,
		nvl(t2.notactive_cell_count,0) 其他状态小区数量,
		t1.cell_count+nvl(t2.notactive_cell_count,0) 小区总数,
		t4.hours 计数器采集小时数,
		t1.cell_count*t4.hours 期望采集计数器记录数,
		nvl(t4.record_count,0)+nvl(t5.record_count,0)+nvl(t6.record_count,0) 实际采集计数器记录数,
		round(((nvl(t4.record_count,0)+nvl(t5.record_count,0)+nvl(t6.record_count,0))/t1.cell_count/t4.hours*100),2) 分地市计数器采集完备率,
		t3.hours KPI采集小时数,
		t1.cell_count*t3.hours 期望采集KPI计录数,
		t3.record_count 实际采集KPI记录数,
		round((t3.record_count/t1.cell_count/t3.hours*100),2) 分地市KPI采集完备率
		from 
		(
		select 
		grouping_id(city_name) sort_id,
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) bsc_count
		from cm.f_g_c_bsc group by rollup(city_name)
		) t0
		left join
		(
		select 
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) cell_count
		from cm.f_g_c_cell where state='入网在用' group by rollup(city_name)
		) t1
		on t0.city_name=t1.city_name
		left join
		(
		select 
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) notactive_cell_count
		from cm.f_g_c_cell where state<>'入网在用' group by rollup(city_name)
		) t2
		on t0.city_name=t2.city_name
		left join
		(
		select
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) record_count,
		count(distinct start_time) hours
		from pm.f_g_c_cell_hour 
		where start_time>=trunc(sysdate-1) and start_time<trunc(sysdate) and bsche00 is not null
		group by rollup(city_name)
		) t3
		on t0.city_name=t3.city_name
		left join
		(
		select
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) record_count,
		count(distinct start_time) hours
		from pm.o_g_e_r12_h_celtchf 
		where start_time>=trunc(sysdate-1) and start_time<trunc(sysdate)
		group by rollup(city_name)
		) t4
		on t0.city_name=t4.city_name
		left join
		(
		select
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) record_count,
		count(distinct start_time) hours
		from pm.O_G_H_R11_1275071420_3 
		where start_time>=trunc(sysdate-1) and start_time<trunc(sysdate)
		group by rollup(city_name)
		) t5
		on t0.city_name=t5.city_name
		left join
		(
		select
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) record_count,
		count(distinct start_time) hours
		from pm.o_g_n_s14_h_traffic 
		where start_time>=trunc(sysdate-1) and start_time<trunc(sysdate)
		group by rollup(city_name)
		) t6
		on t0.city_name=t6.city_name
		order by t0.sort_id,t0.city_name
[2011-07-21 18:53:47][com.inspur.db2excel.Main.oneTable2Excel(Main.java:216)][INFO][main]-day_report.xml:分地市KPI采集完整率 共保存了18条记录
[2011-07-21 18:53:47][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-day_report.xml:-----分地市KPI采集完整率 生成完成-----
[2011-07-21 18:53:47][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-day_report.xml:-----分BSC KPI采集完整率 生成开始-----
[2011-07-21 18:53:47][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-day_report.xml:分BSC KPI采集完整率 sql: select 
		trunc(sysdate) 日期,
		t1.city_name 地市,
		t1.bsc_uk BSC名称,
		t1.vendor_name 厂商名称,
		t1.cell_count 当前激活小区数量,
		nvl(t2.notactive_cell_count,0) 其他状态小区数量,
		t1.cell_count+nvl(t2.notactive_cell_count,0) 小区总数,
		t4.hours 计数器采集小时数,
		t1.cell_count*t4.hours 期望采集计数器记录数,
		nvl(t4.record_count,0)+nvl(t5.record_count,0)+nvl(t6.record_count,0) 实际采集计数器记录数,
		round(((nvl(t4.record_count,0)+nvl(t5.record_count,0)+nvl(t6.record_count,0))/t1.cell_count/t4.hours*100),2) 分BSC计数器采集完备率,
		t3.hours KPI采集小时数,
		t1.cell_count*t3.hours 期望采集KPI计录数,
		t3.record_count 实际采集KPI记录数,
		round((t3.record_count/t1.cell_count/t3.hours*100),2) 分BSCKPI采集完备率
		from 
		(
		select 
		city_name,bsc_uk,vendor_name,count(*) cell_count
		from cm.f_g_c_cell where state='入网在用' group by city_name,bsc_uk,vendor_name
		) t1
		left join
		(
		select 
		city_name,bsc_uk,vendor_name,count(*) notactive_cell_count
		from cm.f_g_c_cell where state<>'入网在用' group by city_name,bsc_uk,vendor_name
		) t2
		on t1.vendor_name=t2.vendor_name and t1.bsc_uk=t2.bsc_uk and t1.city_name=t2.city_name
		left join
		(
		select
		city_name,bsc_uk,vendor_name,
		count(*) record_count,
		count(distinct start_time) hours
		from pm.f_g_c_cell_hour 
		where start_time>=trunc(sysdate-1) and start_time<trunc(sysdate) and bsche00 is not null
		group by city_name,bsc_uk,vendor_name
		) t3
		on t1.vendor_name=t3.vendor_name and t1.bsc_uk=t3.bsc_uk and t1.city_name=t3.city_name
		left join
		(
		select
		city_name,bsc_uk,'爱立信' vendor_name,
		count(*) record_count,
		count(distinct start_time) hours
		from pm.o_g_e_r12_h_celtchf 
		where start_time>=trunc(sysdate-1) and start_time<trunc(sysdate)
		group by city_name,bsc_uk
		) t4
		on t1.vendor_name=t4.vendor_name and t1.bsc_uk=t4.bsc_uk and t1.city_name=t4.city_name
		left join
		(
		select
		city_name,bsc_uk,'华为' vendor_name,
		count(*) record_count,
		count(distinct start_time) hours
		from pm.O_G_H_R11_1275071420_3 
		where start_time>=trunc(sysdate-1) and start_time<trunc(sysdate)
		group by city_name,bsc_uk
		) t5
		on t1.vendor_name=t5.vendor_name and t1.bsc_uk=t5.bsc_uk and t1.city_name=t5.city_name
		left join
		(
		select
		city_name,bsc_uk,'诺基亚' vendor_name,
		count(*) record_count,
		count(distinct start_time) hours
		from pm.o_g_n_s14_h_traffic 
		where start_time>=trunc(sysdate-1) and start_time<trunc(sysdate)
		group by city_name,bsc_uk
		) t6
		on t1.vendor_name=t6.vendor_name and t1.bsc_uk=t6.bsc_uk and t1.city_name=t6.city_name
		order by t1.vendor_name,t1.bsc_uk
[2011-07-21 18:53:48][com.inspur.db2excel.Main.oneTable2Excel(Main.java:213)][INFO][main]-day_report.xml:分BSC KPI采集完整率 保存了101条记录
[2011-07-21 18:53:49][com.inspur.db2excel.Main.oneTable2Excel(Main.java:213)][INFO][main]-day_report.xml:分BSC KPI采集完整率 保存了201条记录
[2011-07-21 18:53:49][com.inspur.db2excel.Main.oneTable2Excel(Main.java:213)][INFO][main]-day_report.xml:分BSC KPI采集完整率 保存了301条记录
[2011-07-21 18:53:49][com.inspur.db2excel.Main.oneTable2Excel(Main.java:213)][INFO][main]-day_report.xml:分BSC KPI采集完整率 保存了401条记录
[2011-07-21 18:53:49][com.inspur.db2excel.Main.oneTable2Excel(Main.java:213)][INFO][main]-day_report.xml:分BSC KPI采集完整率 保存了501条记录
[2011-07-21 18:53:49][com.inspur.db2excel.Main.oneTable2Excel(Main.java:216)][INFO][main]-day_report.xml:分BSC KPI采集完整率 共保存了591条记录
[2011-07-21 18:53:49][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-day_report.xml:-----分BSC KPI采集完整率 生成完成-----
[2011-07-21 18:53:49][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-day_report.xml:-----分地市MRR采集情况 生成开始-----
[2011-07-21 18:53:49][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-day_report.xml:分地市MRR采集情况 sql: select 
		trunc(sysdate) 日期,
		t0.city_name 地市,
		t0.bsc_count BSC数量,
		t1.cell_count 当前激活小区数量,
		nvl(t2.notactive_cell_count,0) 其他状态小区数量,
		t1.cell_count+nvl(t2.notactive_cell_count,0) 小区总数,
		t3.hours MR采集小时数,
		t1.cell_count*t3.hours 期望采集MR计录数,
		t3.record_count 实际采集MR记录数,
		nvl(round((t3.record_count/t1.cell_count/t3.hours*100),2),0) 分地市MR采集完备率
		from 
		(
		select
		grouping_id(city_name) sort_id,
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) bsc_count
		from cm.f_g_c_bsc 
		group by rollup(city_name)
		) t0
		left join
		(
		select 
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) cell_count
		from cm.f_g_c_cell where state='入网在用' group by rollup(city_name)
		) t1
		on t0.city_name=t1.city_name
		left join
		(
		select 
		decode(grouping_id(city_name),0,city_name,'全省') city_name,
		count(*) notactive_cell_count
		from cm.f_g_c_cell where state<>'入网在用' group by rollup(city_name)
		) t2
		on t0.city_name=t2.city_name
		left join
		(
		select
		decode(grouping_id(regionname),0,regionname,'全省') regionname,
		count(*) record_count,
		count(distinct starttime) hours
		from sdpm.cell_mr_h 
		where starttime>=trunc(sysdate-1) and starttime<trunc(sysdate) 
		group by rollup(regionname)
		) t3
		on t0.city_name=t3.regionname
		order by t0.sort_id,t0.city_name
[2011-07-21 18:53:50][com.inspur.db2excel.Main.oneTable2Excel(Main.java:216)][INFO][main]-day_report.xml:分地市MRR采集情况 共保存了18条记录
[2011-07-21 18:53:50][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-day_report.xml:-----分地市MRR采集情况 生成完成-----
[2011-07-21 18:53:50][com.inspur.db2excel.Main.db2excel(Main.java:106)][INFO][main]-day_report.xml:-----分BSC的MRR采集完备情况 生成开始-----
[2011-07-21 18:53:50][com.inspur.db2excel.Main.oneTable2Excel(Main.java:140)][INFO][main]-day_report.xml:分BSC的MRR采集完备情况 sql: select 
		trunc(sysdate) 日期,
		t1.city_name 地市,
		t1.bsc_uk BSC名称,
		t1.cell_count 当前激活小区数量,
		nvl(t2.notactive_cell_count,0) 其他状态小区数量,
		t1.cell_count+nvl(t2.notactive_cell_count,0) 小区总数,
		t3.hours MR采集小时数,
		t1.cell_count*t3.hours 期望采集MR计录数,
		t3.record_count 实际采集MR记录数,
		nvl(round((t3.record_count/t1.cell_count/t3.hours*100),2),0) 分BSCMR采集完备率
		from 
		(
		select 
		city_name,bsc_uk,
		count(*) cell_count
		from cm.f_g_c_cell where state='入网在用' group by city_name,bsc_uk
		) t1
		left join
		(
		select 
		city_name,bsc_uk,
		count(*) notactive_cell_count
		from cm.f_g_c_cell where state<>'入网在用' group by city_name,bsc_uk
		) t2
		on t1.bsc_uk=t2.bsc_uk and t1.city_name=t2.city_name
		left join
		(
		select
		regionname,
		bscid,
		count(*) record_count,
		count(distinct starttime) hours
		from sdpm.cell_mr_h 
		where starttime>=trunc(sysdate-1) and starttime<trunc(sysdate) 
		group by regionname,bscid
		) t3
		on t1.bsc_uk=t3.bscid and t1.city_name=t3.regionname
		order by t1.city_name
[2011-07-21 18:53:50][com.inspur.db2excel.Main.oneTable2Excel(Main.java:213)][INFO][main]-day_report.xml:分BSC的MRR采集完备情况 保存了101条记录
[2011-07-21 18:53:50][com.inspur.db2excel.Main.oneTable2Excel(Main.java:213)][INFO][main]-day_report.xml:分BSC的MRR采集完备情况 保存了201条记录
[2011-07-21 18:53:51][com.inspur.db2excel.Main.oneTable2Excel(Main.java:213)][INFO][main]-day_report.xml:分BSC的MRR采集完备情况 保存了301条记录
[2011-07-21 18:53:51][com.inspur.db2excel.Main.oneTable2Excel(Main.java:213)][INFO][main]-day_report.xml:分BSC的MRR采集完备情况 保存了401条记录
[2011-07-21 18:53:51][com.inspur.db2excel.Main.oneTable2Excel(Main.java:213)][INFO][main]-day_report.xml:分BSC的MRR采集完备情况 保存了501条记录
[2011-07-21 18:53:51][com.inspur.db2excel.Main.oneTable2Excel(Main.java:216)][INFO][main]-day_report.xml:分BSC的MRR采集完备情况 共保存了591条记录
[2011-07-21 18:53:51][com.inspur.db2excel.Main.db2excel(Main.java:112)][INFO][main]-day_report.xml:-----分BSC的MRR采集完备情况 生成完成-----
[2011-07-21 18:53:51][com.inspur.db2excel.Main.db2excel(Main.java:117)][INFO][main]-day_report.xml:=====Excel文件../excel/DATA_QUARLITY/20110721/数据质量日报-20110721_185345.xls保存完成=====
